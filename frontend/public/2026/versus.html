<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Versus / Duel ‚Äî Comparer 2 produits | HIGH-TECH 2026</title>
    <meta name="description" content="Comparez deux produits tech en duel direct, spec par spec, avec un verdict automatique. Quel produit remporte le duel ?">
    <meta name="keywords" content="versus, duel, comparatif, comparaison produits, gaming, high-tech 2026">
    <meta name="robots" content="index, follow">

    <meta property="og:type" content="website">
    <meta property="og:title" content="Versus / Duel ‚Äî HIGH-TECH 2026">
    <meta property="og:description" content="Comparez deux produits tech en duel direct, spec par spec, avec un verdict automatique.">
    <meta property="og:url" content="https://high-tech-2026.com/2026/versus.html">

    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#d4ff00">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="/assets/images/icons/icon-192x192.png">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=Orbitron:wght@500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/theme.css">

    <style>
        main { padding-top: 100px; min-height: 100vh; }

        /* ===== PAGE HEADER ===== */
        .page-header {
            text-align: center;
            padding: 2.5rem 2rem 1.5rem;
        }
        .page-title {
            font-family: 'Orbitron', sans-serif;
            font-size: clamp(2rem, 5vw, 3rem);
            font-weight: 800;
            background: linear-gradient(135deg, #4dd4ff, #ff4da6);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }
        .page-subtitle {
            color: var(--text-secondary);
            font-size: 1.05rem;
            max-width: 600px;
            margin: 0 auto;
        }

        /* ===== SELECTION PHASE ===== */
        .selection-phase {
            max-width: 1100px;
            margin: 0 auto;
            padding: 2rem;
        }

        .selection-grid {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 1.5rem;
            align-items: start;
            margin-bottom: 2rem;
        }

        .selector-panel {
            background: var(--bg-card);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            transition: border-color 0.3s;
        }
        .selector-panel.p1 { border-top: 3px solid var(--tech-blue); }
        .selector-panel.p2 { border-top: 3px solid #ff4da6; }

        .selector-label {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.85rem;
            font-weight: 700;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            margin-bottom: 1rem;
        }
        .selector-panel.p1 .selector-label { color: var(--tech-blue); }
        .selector-panel.p2 .selector-label { color: #ff4da6; }

        .selector-select {
            width: 100%;
            padding: 0.6rem 1rem;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-family: 'Poppins', sans-serif;
            font-size: 0.9rem;
            cursor: pointer;
            margin-bottom: 0.75rem;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23888'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 20px;
            padding-right: 2.5rem;
        }
        .selector-select:focus {
            outline: none;
            border-color: rgba(77,212,255,0.4);
        }
        .selector-select option {
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        /* Product preview in selector */
        .product-preview {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.75rem;
            background: rgba(255,255,255,0.03);
            border-radius: var(--radius-md);
            min-height: 72px;
            border: 1px dashed rgba(255,255,255,0.08);
            transition: all 0.3s;
        }
        .product-preview.selected {
            border-style: solid;
        }
        .selector-panel.p1 .product-preview.selected { border-color: rgba(77,212,255,0.3); background: rgba(77,212,255,0.05); }
        .selector-panel.p2 .product-preview.selected { border-color: rgba(255,77,166,0.3); background: rgba(255,77,166,0.05); }

        .preview-img {
            width: 56px;
            height: 56px;
            object-fit: contain;
            border-radius: 8px;
            flex-shrink: 0;
        }
        .preview-placeholder {
            width: 56px;
            height: 56px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            flex-shrink: 0;
        }
        .preview-info {
            flex: 1;
            min-width: 0;
        }
        .preview-name {
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .preview-price {
            font-size: 0.85rem;
            color: var(--tech-yellow);
            font-weight: 600;
        }
        .preview-cat {
            font-size: 0.75rem;
            color: var(--text-muted);
        }
        .preview-empty {
            color: var(--text-muted);
            font-size: 0.9rem;
            text-align: center;
            width: 100%;
        }

        /* VS separator */
        .vs-separator {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding-top: 3rem;
            gap: 0.5rem;
        }
        .vs-badge {
            font-family: 'Orbitron', sans-serif;
            font-size: 2rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--tech-yellow), #ffaa00);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: none;
            line-height: 1;
        }
        .vs-line {
            width: 2px;
            height: 40px;
            background: linear-gradient(to bottom, transparent, rgba(212,255,0,0.3), transparent);
        }

        /* Launch button */
        .launch-area {
            text-align: center;
        }
        .launch-btn {
            padding: 1rem 3rem;
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--tech-blue), #ff4da6);
            border: none;
            border-radius: var(--radius-full);
            color: #fff;
            cursor: pointer;
            transition: all 0.3s;
            letter-spacing: 0.05em;
            opacity: 0.4;
            pointer-events: none;
        }
        .launch-btn.ready {
            opacity: 1;
            pointer-events: all;
            box-shadow: 0 0 30px rgba(77,212,255,0.3);
        }
        .launch-btn.ready:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 50px rgba(77,212,255,0.5);
        }

        /* ===== DUEL PHASE ===== */
        .duel-phase {
            display: none;
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        .duel-phase.visible { display: block; }

        /* Duel actions bar */
        .duel-actions {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        .action-btn {
            padding: 0.6rem 1.5rem;
            border-radius: var(--radius-full);
            border: 1px solid rgba(255,255,255,0.15);
            background: var(--bg-card);
            color: var(--text-primary);
            font-family: 'Poppins', sans-serif;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }
        .action-btn:hover {
            border-color: var(--tech-yellow);
            color: var(--tech-yellow);
        }

        /* Duel header ‚Äî produits c√¥te √† c√¥te */
        .duel-header {
            display: grid;
            grid-template-columns: 1fr 80px 1fr;
            gap: 1rem;
            margin-bottom: 2rem;
            align-items: stretch;
        }
        .duel-product-card {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            text-align: center;
            border: 2px solid transparent;
            position: relative;
            transition: all 0.3s;
        }
        .duel-product-card.p1 { border-color: rgba(77,212,255,0.4); }
        .duel-product-card.p2 { border-color: rgba(255,77,166,0.4); }
        .duel-product-card.winner {
            box-shadow: 0 0 40px rgba(212,255,0,0.2);
        }

        .winner-crown {
            position: absolute;
            top: -18px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 2rem;
            animation: pulse-crown 2s ease-in-out infinite;
        }
        @keyframes pulse-crown {
            0%, 100% { transform: translateX(-50%) scale(1); }
            50% { transform: translateX(-50%) scale(1.15); }
        }

        .duel-product-img {
            width: 110px;
            height: 110px;
            object-fit: contain;
            margin: 0 auto 1rem;
            display: block;
            border-radius: 12px;
        }
        .duel-product-name {
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }
        .duel-product-cat {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-bottom: 0.5rem;
        }
        .duel-product-price {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        .duel-product-card.p1 .duel-product-price { color: var(--tech-blue); }
        .duel-product-card.p2 .duel-product-price { color: #ff4da6; }

        .price-badge {
            display: inline-block;
            padding: 0.2rem 0.75rem;
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: 600;
        }
        .price-badge.cheaper {
            background: rgba(107,255,107,0.15);
            color: var(--tech-green);
            border: 1px solid rgba(107,255,107,0.3);
        }
        .price-badge.pricier {
            background: rgba(255,100,100,0.1);
            color: #ff6464;
            border: 1px solid rgba(255,100,100,0.2);
        }
        .price-badge.equal {
            background: rgba(212,255,0,0.1);
            color: var(--tech-yellow);
            border: 1px solid rgba(212,255,0,0.2);
        }

        .duel-score-badge {
            display: inline-block;
            padding: 0.3rem 1rem;
            border-radius: var(--radius-full);
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1rem;
            font-weight: 700;
            margin-top: 0.5rem;
        }
        .duel-product-card.p1 .duel-score-badge { background: rgba(77,212,255,0.15); color: var(--tech-blue); }
        .duel-product-card.p2 .duel-score-badge { background: rgba(255,77,166,0.15); color: #ff4da6; }

        .fiche-link {
            display: inline-block;
            margin-top: 0.75rem;
            padding: 0.4rem 1rem;
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: var(--radius-full);
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.8rem;
            transition: all 0.3s;
        }
        .fiche-link:hover {
            border-color: var(--tech-yellow);
            color: var(--tech-yellow);
        }

        /* VS center in duel header */
        .duel-vs {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .duel-vs-text {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.8rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--tech-yellow), #ffaa00);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* ===== COMPARISON SECTIONS ===== */
        .comparison-section {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            margin-bottom: 1.5rem;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.06);
        }
        .comparison-section-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.85rem;
            font-weight: 700;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: var(--text-muted);
            padding: 1rem 1.5rem;
            border-bottom: 1px solid rgba(255,255,255,0.06);
            background: rgba(255,255,255,0.02);
        }

        /* Features side by side */
        .features-duel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
        }
        .features-col {
            padding: 1.25rem 1.5rem;
        }
        .features-col:first-child {
            border-right: 1px solid rgba(255,255,255,0.06);
        }
        .feature-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        .feature-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.85rem;
            color: var(--text-primary);
        }
        .feature-check {
            font-size: 0.75rem;
            font-weight: 700;
            flex-shrink: 0;
        }
        .features-col.p1 .feature-check { color: var(--tech-blue); }
        .features-col.p2 .feature-check { color: #ff4da6; }
        .feature-count {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-bottom: 0.75rem;
        }
        .feature-winner-badge {
            display: inline-block;
            padding: 0.15rem 0.6rem;
            border-radius: var(--radius-full);
            font-size: 0.7rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }
        .feature-winner-badge.p1 { background: rgba(77,212,255,0.15); color: var(--tech-blue); }
        .feature-winner-badge.p2 { background: rgba(255,77,166,0.15); color: #ff4da6; }
        .no-features { color: var(--text-muted); font-size: 0.85rem; font-style: italic; }

        /* Specs rows */
        .specs-duel {
            display: flex;
            flex-direction: column;
        }
        .spec-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            border-bottom: 1px solid rgba(255,255,255,0.04);
        }
        .spec-row:last-child { border-bottom: none; }
        .spec-cell {
            padding: 0.9rem 1.5rem;
            font-size: 0.85rem;
        }
        .spec-cell:first-child { border-right: 1px solid rgba(255,255,255,0.04); }
        .spec-cell-label {
            font-weight: 600;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.3rem;
        }
        .spec-cell.p1 .spec-cell-label { color: var(--tech-blue); }
        .spec-cell.p2 .spec-cell-label { color: #ff4da6; }
        .spec-cell-value {
            color: var(--text-secondary);
            line-height: 1.5;
        }

        /* Score summary */
        .score-section {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 2rem;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.06);
            margin-bottom: 1.5rem;
            position: relative;
            overflow: hidden;
        }
        .score-section::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, rgba(77,212,255,0.03), rgba(255,77,166,0.03));
            pointer-events: none;
        }
        .score-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 1.5rem;
        }
        .score-display {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
        }
        .score-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }
        .score-name {
            font-size: 0.9rem;
            font-weight: 600;
        }
        .score-item.p1 .score-name { color: var(--tech-blue); }
        .score-item.p2 .score-name { color: #ff4da6; }
        .score-points {
            font-family: 'Orbitron', sans-serif;
            font-size: 3rem;
            font-weight: 800;
            line-height: 1;
        }
        .score-item.p1 .score-points { color: var(--tech-blue); }
        .score-item.p2 .score-points { color: #ff4da6; }
        .score-dash {
            font-family: 'Orbitron', sans-serif;
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-muted);
        }
        .winner-announce {
            margin-top: 1.5rem;
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            padding: 0.6rem 2rem;
            border-radius: var(--radius-full);
            display: inline-block;
        }
        .winner-announce.p1 { background: rgba(77,212,255,0.15); color: var(--tech-blue); border: 1px solid rgba(77,212,255,0.3); }
        .winner-announce.p2 { background: rgba(255,77,166,0.15); color: #ff4da6; border: 1px solid rgba(255,77,166,0.3); }
        .winner-announce.draw { background: rgba(212,255,0,0.15); color: var(--tech-yellow); border: 1px solid rgba(212,255,0,0.3); }

        /* Score criteria breakdown */
        .score-criteria {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }
        .criteria-item {
            font-size: 0.8rem;
            color: var(--text-muted);
            padding: 0.25rem 0.75rem;
            border-radius: var(--radius-full);
            background: rgba(255,255,255,0.04);
        }
        .criteria-item.win-p1 { color: var(--tech-blue); background: rgba(77,212,255,0.08); }
        .criteria-item.win-p2 { color: #ff4da6; background: rgba(255,77,166,0.08); }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .selection-grid {
                grid-template-columns: 1fr;
            }
            .vs-separator {
                flex-direction: row;
                padding-top: 0;
                justify-content: center;
            }
            .vs-line { width: 40px; height: 2px; }

            .duel-header {
                grid-template-columns: 1fr;
                gap: 0.5rem;
            }
            .duel-vs { padding: 0.5rem 0; }
            .duel-vs-text { font-size: 1.2rem; }

            .features-duel { grid-template-columns: 1fr; }
            .features-col:first-child { border-right: none; border-bottom: 1px solid rgba(255,255,255,0.06); }

            .spec-row { grid-template-columns: 1fr; }
            .spec-cell:first-child { border-right: none; border-bottom: 1px solid rgba(255,255,255,0.04); }

            .score-display { gap: 1rem; }
            .score-points { font-size: 2rem; }
        }
    </style>
</head>
<body>

    <header class="header">
        <nav class="nav-container">
            <a href="/2026/" class="logo-section">
                <svg class="logo" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <linearGradient id="logoBg" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#d4ff00;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#6bff6b;stop-opacity:1" />
                        </linearGradient>
                    </defs>
                    <polygon points="50,15 85,35 85,65 50,85 15,65 15,35" fill="none" stroke="url(#logoBg)" stroke-width="2.5" opacity="0.9"/>
                    <path d="M 50 25 L 58 45 L 48 45 L 54 70 L 38 48 L 50 48 Z" fill="url(#logoBg)" opacity="0.95"/>
                    <circle cx="30" cy="40" r="2.5" fill="#4dd4ff" opacity="0.7"/>
                    <circle cx="70" cy="60" r="2.5" fill="#a78bfa" opacity="0.7"/>
                </svg>
                <div class="logo-text">HIGH-TECH 2026</div>
            </a>
            <div class="nav-links">
                <a href="/2026/" class="nav-link">Accueil</a>
                <a href="/2026/#categories" class="nav-link">Cat√©gories</a>
                <a href="/2026/guides.html" class="nav-link">Guides</a>
                <a href="/2026/comparatif.html" class="nav-link">Comparatif</a>
                <a href="/2026/recherche.html" class="nav-link">Rechercher</a>
            </div>
        </nav>
    </header>

    <main>
        <div class="page-header">
            <nav style="margin-bottom: 1rem;">
                <a href="/2026/" style="color: var(--text-muted); text-decoration: none;">Accueil</a>
                <span style="color: var(--text-muted); margin: 0 0.5rem;">/</span>
                <span style="color: #4dd4ff;">Versus</span>
            </nav>
            <h1 class="page-title">‚öîÔ∏è Versus / Duel</h1>
            <p class="page-subtitle">S√©lectionne 2 produits et d√©couvre lequel remporte le duel, spec par spec.</p>
        </div>

        <!-- ===== SELECTION PHASE ===== -->
        <div class="selection-phase" id="selection-phase">
            <div class="selection-grid">

                <!-- Produit 1 -->
                <div class="selector-panel p1">
                    <div class="selector-label">‚ö° Produit 1</div>
                    <select class="selector-select" id="cat-select-1" onchange="loadProductsForSlot(1)">
                        <option value="">‚Äî Cat√©gorie ‚Äî</option>
                    </select>
                    <select class="selector-select" id="prod-select-1" style="display:none" onchange="selectProduct(1, this.value)">
                        <option value="">‚Äî Produit ‚Äî</option>
                    </select>
                    <div class="product-preview" id="preview-1">
                        <div class="preview-placeholder">üéÆ</div>
                        <span class="preview-empty">Aucun produit s√©lectionn√©</span>
                    </div>
                </div>

                <!-- VS -->
                <div class="vs-separator">
                    <div class="vs-line"></div>
                    <div class="vs-badge">VS</div>
                    <div class="vs-line"></div>
                </div>

                <!-- Produit 2 -->
                <div class="selector-panel p2">
                    <div class="selector-label">üî• Produit 2</div>
                    <select class="selector-select" id="cat-select-2" onchange="loadProductsForSlot(2)">
                        <option value="">‚Äî Cat√©gorie ‚Äî</option>
                    </select>
                    <select class="selector-select" id="prod-select-2" style="display:none" onchange="selectProduct(2, this.value)">
                        <option value="">‚Äî Produit ‚Äî</option>
                    </select>
                    <div class="product-preview" id="preview-2">
                        <div class="preview-placeholder">üñ•Ô∏è</div>
                        <span class="preview-empty">Aucun produit s√©lectionn√©</span>
                    </div>
                </div>
            </div>

            <div class="launch-area">
                <button class="launch-btn" id="launch-btn" onclick="launchDuel()">‚ö° Lancer le Duel</button>
            </div>
        </div>

        <!-- ===== DUEL PHASE ===== -->
        <div class="duel-phase" id="duel-phase">

            <div class="duel-actions">
                <button class="action-btn" onclick="resetDuel()">üîÑ Nouveau duel</button>
                <button class="action-btn" onclick="shareUrl()">üîó Partager ce duel</button>
            </div>

            <!-- Score summary (shown first) -->
            <div class="score-section" id="score-section">
                <div class="score-title">üèÜ Verdict Final</div>
                <div class="score-display">
                    <div class="score-item p1">
                        <div class="score-name" id="score-name-1">Produit 1</div>
                        <div class="score-points" id="score-p1">0</div>
                        <div style="font-size: 0.75rem; color: var(--text-muted);">points</div>
                    </div>
                    <div class="score-dash">‚Äî</div>
                    <div class="score-item p2">
                        <div class="score-name" id="score-name-2">Produit 2</div>
                        <div class="score-points" id="score-p2">0</div>
                        <div style="font-size: 0.75rem; color: var(--text-muted);">points</div>
                    </div>
                </div>
                <div id="winner-announce" class="winner-announce draw" style="display:none"></div>
                <div class="score-criteria" id="score-criteria"></div>
            </div>

            <!-- Duel header cards -->
            <div class="duel-header" id="duel-header">
                <div class="duel-product-card p1" id="duel-card-1">
                    <div class="duel-product-name" id="duel-name-1"></div>
                </div>
                <div class="duel-vs">
                    <div class="duel-vs-text">VS</div>
                </div>
                <div class="duel-product-card p2" id="duel-card-2">
                    <div class="duel-product-name" id="duel-name-2"></div>
                </div>
            </div>

            <!-- Fonctionnalit√©s -->
            <div class="comparison-section" id="features-section" style="display:none">
                <div class="comparison-section-title">‚ú® Fonctionnalit√©s</div>
                <div class="features-duel">
                    <div class="features-col p1" id="features-col-1"></div>
                    <div class="features-col p2" id="features-col-2"></div>
                </div>
            </div>

            <!-- Specs -->
            <div class="comparison-section" id="specs-section" style="display:none">
                <div class="comparison-section-title">üìã Sp√©cifications</div>
                <div class="specs-duel" id="specs-rows"></div>
            </div>

        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3>HIGH-TECH 2026</h3>
                <p style="color: var(--text-secondary); line-height: 1.7;">
                    Votre source d'information de confiance pour la technologie de pointe.
                </p>
            </div>
            <div class="footer-section">
                <h3>Navigation</h3>
                <ul class="footer-links">
                    <li><a href="/2026/">Accueil</a></li>
                    <li><a href="/2026/produits.html">Produits</a></li>
                    <li><a href="/2026/tendances.html">Tendances</a></li>
                    <li><a href="/2026/comparatif.html">Comparatif</a></li>
                    <li><a href="/2026/versus.html">Versus</a></li>
                    <li><a href="/2026/guides.html">Guides</a></li>
                    <li><a href="/2026/configurateur.html">Configurateur</a></li>
                    <li><a href="/2026/evolution-prix.html">√âvolution des Prix</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Cat√©gories</h3>
                <ul class="footer-links">
                    <li><a href="/2026/produits.html?categorie=smartphone">Smartphones</a></li>
                    <li><a href="/2026/produits.html?categorie=pc-gaming">PC Gaming</a></li>
                    <li><a href="/2026/produits.html?categorie=console">Consoles</a></li>
                    <li><a href="/2026/produits.html?categorie=casque-vr">VR/AR</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Ressources</h3>
                <ul class="footer-links">
                    <li><a href="/2026/wiki.html">Wiki</a></li>
                    <li><a href="/2026/timeline.html">Timeline Tech</a></li>
                    <li><a href="/2026/apropos.html">√Ä propos</a></li>
                    <li><a href="/2026/admin.html">Admin</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2026 HIGH-TECH 2026 ‚Äî Cr√©√© par Genin Wilfried. Tous droits r√©serv√©s.</p>
        </div>
    </footer>

    <button class="scroll-top" id="scrollTop">^</button>

    <script src="/assets/js/theme-toggle.js"></script>
    <script>
        // ===== STATE =====
        let allProducts = [];
        let selectedProducts = { 1: null, 2: null };

        // ===== INIT =====
        document.addEventListener('DOMContentLoaded', () => {
            loadAllProducts();
            initScrollTop();
        });

        function initScrollTop() {
            const btn = document.getElementById('scrollTop');
            if (!btn) return;
            window.addEventListener('scroll', () => {
                btn.classList.toggle('visible', window.scrollY > 300);
            });
            btn.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));
        }

        // ===== LOAD PRODUCTS =====
        async function loadAllProducts() {
            try {
                const resp = await fetch('/api/produits?limit=500');
                const data = await resp.json();
                allProducts = data.data || data.produits || data || [];

                populateCategorySelects();
                checkUrlParams();
            } catch (e) {
                console.error('Erreur chargement produits:', e);
            }
        }

        function populateCategorySelects() {
            // Extraire cat√©gories uniques
            const cats = {};
            allProducts.forEach(p => {
                if (p.categorie && !cats[p.categorie]) {
                    cats[p.categorie] = p.categorie_nom || formatCatName(p.categorie);
                }
            });

            const options = Object.entries(cats)
                .sort((a, b) => a[1].localeCompare(b[1]))
                .map(([slug, nom]) => `<option value="${slug}">${nom}</option>`)
                .join('');

            ['cat-select-1', 'cat-select-2'].forEach(id => {
                const sel = document.getElementById(id);
                sel.innerHTML = `<option value="">‚Äî Cat√©gorie ‚Äî</option>` + options;
            });
        }

        function formatCatName(slug) {
            return slug.split('-').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');
        }

        // ===== CATEGORY ‚Üí PRODUCTS =====
        function loadProductsForSlot(slot) {
            const cat = document.getElementById(`cat-select-${slot}`).value;
            const prodSel = document.getElementById(`prod-select-${slot}`);

            if (!cat) {
                prodSel.style.display = 'none';
                return;
            }

            const filtered = allProducts.filter(p => p.categorie === cat);
            prodSel.innerHTML = `<option value="">‚Äî Produit ‚Äî</option>` +
                filtered.map(p => `<option value="${p.id}">${displayName(p)}</option>`).join('');
            prodSel.style.display = 'block';

            // Reset current selection if category changed
            if (selectedProducts[slot]) {
                selectedProducts[slot] = null;
                updatePreview(slot, null);
                updateLaunchBtn();
            }
        }

        // ===== SELECT PRODUCT =====
        function selectProduct(slot, id) {
            if (!id) {
                selectedProducts[slot] = null;
                updatePreview(slot, null);
                updateLaunchBtn();
                return;
            }
            const product = allProducts.find(p => p.id === id);
            selectedProducts[slot] = product || null;
            updatePreview(slot, product);
            updateLaunchBtn();
        }

        function updatePreview(slot, product) {
            const div = document.getElementById(`preview-${slot}`);
            if (!product) {
                div.classList.remove('selected');
                div.innerHTML = `
                    <div class="preview-placeholder">${slot === 1 ? 'üéÆ' : 'üñ•Ô∏è'}</div>
                    <span class="preview-empty">Aucun produit s√©lectionn√©</span>
                `;
                return;
            }
            div.classList.add('selected');
            const imgSrc = product.image ? `/assets/images/${product.image}` : '';
            div.innerHTML = `
                ${imgSrc
                    ? `<img class="preview-img" src="${imgSrc}" alt="${escHtml(displayName(product))}" onerror="this.style.display='none'">`
                    : `<div class="preview-placeholder">üì¶</div>`}
                <div class="preview-info">
                    <div class="preview-name">${escHtml(displayName(product))}</div>
                    ${product.prix ? `<div class="preview-price">${escHtml(product.prix)}</div>` : ''}
                    ${product.categorie ? `<div class="preview-cat">${escHtml(formatCatName(product.categorie))}</div>` : ''}
                </div>
            `;
        }

        function updateLaunchBtn() {
            const btn = document.getElementById('launch-btn');
            const ready = selectedProducts[1] && selectedProducts[2];
            btn.classList.toggle('ready', !!ready);
        }

        // ===== URL PARAMS =====
        function checkUrlParams() {
            const params = new URLSearchParams(window.location.search);
            const id1 = params.get('id1');
            const id2 = params.get('id2');

            if (id1 && id2) {
                const p1 = allProducts.find(p => p.id === id1);
                const p2 = allProducts.find(p => p.id === id2);

                if (p1 && p2) {
                    // Pre-select cat√©gories et produits
                    preselectSlot(1, p1);
                    preselectSlot(2, p2);
                    launchDuel();
                }
            }
        }

        function preselectSlot(slot, product) {
            selectedProducts[slot] = product;

            // Set category select
            const catSel = document.getElementById(`cat-select-${slot}`);
            catSel.value = product.categorie || '';

            // Populate and set product select
            loadProductsForSlot(slot);
            const prodSel = document.getElementById(`prod-select-${slot}`);
            prodSel.value = product.id;

            updatePreview(slot, product);
            updateLaunchBtn();
        }

        // ===== LAUNCH DUEL =====
        function launchDuel() {
            const p1 = selectedProducts[1];
            const p2 = selectedProducts[2];
            if (!p1 || !p2) return;

            // Update URL
            const url = new URL(window.location.href);
            url.searchParams.set('id1', p1.id);
            url.searchParams.set('id2', p2.id);
            window.history.replaceState({}, '', url.toString());

            // Render duel
            renderDuel(p1, p2);

            // Scroll to duel
            document.getElementById('selection-phase').style.display = 'none';
            document.getElementById('duel-phase').classList.add('visible');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // ===== RENDER DUEL =====
        function renderDuel(p1, p2) {
            const score = computeScore(p1, p2);

            renderProductCard(1, p1, score);
            renderProductCard(2, p2, score);
            renderScore(p1, p2, score);
            renderFeatures(p1, p2, score);
            renderSpecs(p1, p2);
        }

        // ===== SCORE COMPUTATION =====
        function computeScore(p1, p2) {
            const score = { p1: 0, p2: 0, criteria: [] };

            // 1. Prix (moins cher gagne)
            const price1 = parsePrice(p1.prix);
            const price2 = parsePrice(p2.prix);
            if (price1 !== null && price2 !== null) {
                if (price1 < price2) {
                    score.p1++;
                    score.criteria.push({ label: 'üí∞ Prix', winner: 1 });
                } else if (price2 < price1) {
                    score.p2++;
                    score.criteria.push({ label: 'üí∞ Prix', winner: 2 });
                } else {
                    score.criteria.push({ label: 'üí∞ Prix', winner: 0 });
                }
            }

            // 2. Fonctionnalit√©s (plus de features gagne)
            const f1 = (p1.fonctionnalites_avancees || []).length;
            const f2 = (p2.fonctionnalites_avancees || []).length;
            if (f1 > 0 || f2 > 0) {
                if (f1 > f2) {
                    score.p1++;
                    score.criteria.push({ label: '‚ú® Fonctionnalit√©s', winner: 1 });
                } else if (f2 > f1) {
                    score.p2++;
                    score.criteria.push({ label: '‚ú® Fonctionnalit√©s', winner: 2 });
                } else {
                    score.criteria.push({ label: '‚ú® Fonctionnalit√©s', winner: 0 });
                }
            }

            // 3. Specs (plus de specs gagne)
            const s1 = (p1.donnees_fiche || []).length;
            const s2 = (p2.donnees_fiche || []).length;
            if (s1 > 0 || s2 > 0) {
                if (s1 > s2) {
                    score.p1++;
                    score.criteria.push({ label: 'üìã Specs', winner: 1 });
                } else if (s2 > s1) {
                    score.p2++;
                    score.criteria.push({ label: 'üìã Specs', winner: 2 });
                } else {
                    score.criteria.push({ label: 'üìã Specs', winner: 0 });
                }
            }

            return score;
        }

        function parsePrice(str) {
            if (!str) return null;
            const cleaned = str.replace(/[^0-9,.\s]/g, '').replace(',', '.').replace(/\s/g, '');
            const n = parseFloat(cleaned);
            return isNaN(n) ? null : n;
        }

        // ===== RENDER PRODUCT CARDS =====
        function renderProductCard(slot, product, score) {
            const card = document.getElementById(`duel-card-${slot}`);
            const imgSrc = product.image ? `/assets/images/${product.image}` : '';
            const price1 = parsePrice(product.prix);
            const other = slot === 1 ? selectedProducts[2] : selectedProducts[1];
            const price2 = parsePrice(other.prix);

            let priceBadge = '';
            if (price1 !== null && price2 !== null) {
                if (price1 < price2) priceBadge = `<span class="price-badge cheaper">‚úì Moins cher</span>`;
                else if (price1 > price2) priceBadge = `<span class="price-badge pricier">‚Üë Plus cher</span>`;
                else priceBadge = `<span class="price-badge equal">= M√™me prix</span>`;
            }

            const myScore = slot === 1 ? score.p1 : score.p2;
            const otherScore = slot === 1 ? score.p2 : score.p1;
            const isWinner = myScore > otherScore;
            const isDraw = myScore === otherScore;

            if (isWinner) card.classList.add('winner');

            card.innerHTML = `
                ${isWinner ? '<div class="winner-crown">üëë</div>' : ''}
                ${imgSrc ? `<img class="duel-product-img" src="${imgSrc}" alt="${escHtml(displayName(product))}" onerror="this.style.display='none'">` : ''}
                <div class="duel-product-name">${escHtml(displayName(product))}</div>
                ${product.categorie ? `<div class="duel-product-cat">${escHtml(formatCatName(product.categorie))}</div>` : ''}
                ${product.prix ? `<div class="duel-product-price">${escHtml(product.prix)}</div>` : ''}
                ${priceBadge}
                <div class="duel-score-badge">${myScore} pt${myScore !== 1 ? 's' : ''}</div>
                <br>
                <a class="fiche-link" href="/2026/fiche.html?id=${product.id}" target="_blank">Voir la fiche ‚Üí</a>
            `;
        }

        // ===== RENDER SCORE =====
        function renderScore(p1, p2, score) {
            document.getElementById('score-name-1').textContent = truncate(displayName(p1), 20);
            document.getElementById('score-name-2').textContent = truncate(displayName(p2), 20);
            document.getElementById('score-p1').textContent = score.p1;
            document.getElementById('score-p2').textContent = score.p2;

            const announce = document.getElementById('winner-announce');
            announce.style.display = 'inline-block';

            if (score.p1 > score.p2) {
                announce.className = 'winner-announce p1';
                announce.textContent = `üëë ${truncate(displayName(p1), 25)} remporte le duel !`;
            } else if (score.p2 > score.p1) {
                announce.className = 'winner-announce p2';
                announce.textContent = `üëë ${truncate(displayName(p2), 25)} remporte le duel !`;
            } else {
                announce.className = 'winner-announce draw';
                announce.textContent = 'ü§ù √âgalit√© parfaite !';
            }

            // Criteria breakdown
            const criteriaEl = document.getElementById('score-criteria');
            criteriaEl.innerHTML = score.criteria.map(c => {
                const cls = c.winner === 1 ? 'win-p1' : c.winner === 2 ? 'win-p2' : '';
                const suffix = c.winner === 1 ? ` ‚Üí ${truncate(displayName(p1), 15)}`
                             : c.winner === 2 ? ` ‚Üí ${truncate(displayName(p2), 15)}` : ' ‚Üí √âgalit√©';
                return `<span class="criteria-item ${cls}">${c.label}${suffix}</span>`;
            }).join('');
        }

        // ===== RENDER FEATURES =====
        function renderFeatures(p1, p2, score) {
            const f1 = p1.fonctionnalites_avancees || [];
            const f2 = p2.fonctionnalites_avancees || [];
            if (f1.length === 0 && f2.length === 0) return;

            // Winner label
            const f1wins = f1.length > f2.length;
            const f2wins = f2.length > f1.length;

            const renderCol = (features, slot, wins) => {
                const badge = wins
                    ? `<span class="feature-winner-badge p${slot}">+${features.length - (slot === 1 ? f2.length : f1.length)} fonctionnalit√©${features.length - (slot === 1 ? f2.length : f1.length) > 1 ? 's' : ''}</span>`
                    : '';

                return `
                    <div class="feature-count">${features.length} fonctionnalit√©${features.length !== 1 ? 's' : ''}${badge}</div>
                    <div class="feature-list">
                        ${features.length > 0
                            ? features.map(f => {
                                const text = typeof f === 'string' ? f : (f.titre || f.nom || '');
                                return `<div class="feature-item"><span class="feature-check">‚úì</span>${escHtml(text)}</div>`;
                            }).join('')
                            : `<div class="no-features">Aucune fonctionnalit√© renseign√©e</div>`}
                    </div>
                `;
            };

            document.getElementById('features-col-1').innerHTML = renderCol(f1, 1, f1wins);
            document.getElementById('features-col-2').innerHTML = renderCol(f2, 2, f2wins);
            document.getElementById('features-section').style.display = 'block';
        }

        // ===== RENDER SPECS =====
        function renderSpecs(p1, p2) {
            const specs1 = parseFiche(p1.donnees_fiche || []);
            const specs2 = parseFiche(p2.donnees_fiche || []);

            if (specs1.length === 0 && specs2.length === 0) return;

            const maxLen = Math.max(specs1.length, specs2.length);
            let rows = '';

            for (let i = 0; i < maxLen; i++) {
                const s1 = specs1[i];
                const s2 = specs2[i];
                rows += `
                    <div class="spec-row">
                        <div class="spec-cell p1">
                            ${s1 ? `<div class="spec-cell-label">${escHtml(s1.title)}</div><div class="spec-cell-value">${s1.content}</div>` : '<div class="spec-cell-value" style="color:var(--text-muted)">‚Äî</div>'}
                        </div>
                        <div class="spec-cell p2">
                            ${s2 ? `<div class="spec-cell-label">${escHtml(s2.title)}</div><div class="spec-cell-value">${s2.content}</div>` : '<div class="spec-cell-value" style="color:var(--text-muted)">‚Äî</div>'}
                        </div>
                    </div>
                `;
            }

            document.getElementById('specs-rows').innerHTML = rows;
            document.getElementById('specs-section').style.display = 'block';
        }

        // Parse donnees_fiche array ‚Üí [{title, content}]
        function parseFiche(arr) {
            return arr.map(spec => {
                if (typeof spec === 'object') {
                    return { title: spec.label || spec.nom || 'Spec', content: escHtml(spec.value || spec.valeur || '‚Äî') };
                }
                if (spec.includes('|')) {
                    const parts = spec.split('|');
                    const titleRaw = parts[0].trim();
                    const title = titleRaw.replace(/^[\u{1F300}-\u{1FFFF}\u{2600}-\u{27BF}]\s*/u, '').trim() || titleRaw;
                    const content = parts.slice(1).join('|').trim()
                        .split(/\s*[‚Ä¢]\s*/).filter(s => s.trim())
                        .map(s => `<span style="display:block">${escHtml(s.trim())}</span>`).join('') || escHtml(parts[1] || '');
                    return { title, content: content || '‚Äî' };
                }
                if (spec.includes('\n')) {
                    const lines = spec.split('\n');
                    const title = lines[0].replace(/^[\u{1F300}-\u{1FFFF}\u{2600}-\u{27BF}]\s*/u, '').trim() || lines[0];
                    const content = lines.slice(1).map(l => `<span style="display:block">${escHtml(l)}</span>`).join('') || '‚Äî';
                    return { title, content };
                }
                return { title: 'Info', content: escHtml(spec) };
            });
        }

        // ===== ACTIONS =====
        function resetDuel() {
            selectedProducts = { 1: null, 2: null };

            // R√©initialiser les selects et previews
            [1, 2].forEach(slot => {
                document.getElementById(`cat-select-${slot}`).value = '';
                const prodSel = document.getElementById(`prod-select-${slot}`);
                prodSel.innerHTML = `<option value="">‚Äî Produit ‚Äî</option>`;
                prodSel.style.display = 'none';
                updatePreview(slot, null);
            });

            // Griser le bouton
            updateLaunchBtn();

            // Masquer la phase duel, afficher la s√©lection
            document.getElementById('duel-phase').classList.remove('visible');
            document.getElementById('selection-phase').style.display = 'block';

            // Reset cards
            ['duel-card-1', 'duel-card-2'].forEach(id => {
                const el = document.getElementById(id);
                el.classList.remove('winner');
                el.innerHTML = '';
            });
            document.getElementById('features-section').style.display = 'none';
            document.getElementById('specs-section').style.display = 'none';

            // Clean URL
            const url = new URL(window.location.href);
            url.searchParams.delete('id1');
            url.searchParams.delete('id2');
            window.history.replaceState({}, '', url.toString());

            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function shareUrl() {
            const url = window.location.href;
            if (navigator.clipboard) {
                navigator.clipboard.writeText(url).then(() => {
                    showToast('üîó URL copi√©e dans le presse-papier !');
                });
            } else {
                prompt('Copie ce lien pour partager le duel :', url);
            }
        }

        function showToast(msg) {
            const t = document.createElement('div');
            t.style.cssText = `
                position: fixed; bottom: 2rem; left: 50%; transform: translateX(-50%);
                background: var(--bg-card); border: 1px solid rgba(255,255,255,0.1);
                color: var(--text-primary); padding: 0.75rem 1.5rem;
                border-radius: 50px; font-size: 0.9rem; font-weight: 500;
                z-index: 9999; box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                animation: fadeIn 0.3s ease;
            `;
            t.textContent = msg;
            document.body.appendChild(t);
            setTimeout(() => t.remove(), 3000);
        }

        // ===== UTILS =====
        // Retourne le vrai nom lisible (titre_affiche ou formatage du slug)
        function displayName(product) {
            if (!product) return '';
            if (product.titre_affiche) return product.titre_affiche;
            // Fallback: convertir slug en titre
            return product.nom
                .split('-')
                .map(w => w.charAt(0).toUpperCase() + w.slice(1))
                .join(' ');
        }

        function escHtml(str) {
            if (str === null || str === undefined) return '';
            return String(str)
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;');
        }

        function truncate(str, max) {
            if (!str) return '';
            return str.length > max ? str.slice(0, max) + '‚Ä¶' : str;
        }
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administration - Gestion des Produits</title>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Manrope', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .admin-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .admin-header {
            background: linear-gradient(45deg, #007bff, #0056b3);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .admin-header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .admin-content {
            padding: 40px;
        }
        
        .section {
            margin-bottom: 40px;
            padding: 30px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            background: #f8f9fa;
        }
        
        .section h2 {
            color: #007bff;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }
        
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0,123,255,0.1);
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, #007bff, #0056b3);
            color: white;
        }
        
        .btn-primary:hover {
            background: linear-gradient(45deg, #0056b3, #004494);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,123,255,0.3);
        }
        
        .btn-success {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
        }
        
        .btn-success:hover {
            background: linear-gradient(45deg, #20c997, #17a2b8);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40,167,69,0.3);
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #007bff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: #007bff;
        }
        
        .stat-label {
            color: #6c757d;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .alert {
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            font-weight: 500;
        }
        
        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .alert-danger {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.9);
            padding: 10px 15px;
            border-radius: 6px;
            text-decoration: none;
            color: #007bff;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .back-link:hover {
            background: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .admin-content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Retour au site</a>
    
    <div class="admin-container">
        <div class="admin-header">
            <h1>üõ†Ô∏è Administration</h1>
            <p>Gestion des produits et g√©n√©ration automatique</p>
        </div>
        
        <div class="admin-content">
            <!-- Statistiques -->
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number" id="total-products">47</div>
                    <div class="stat-label">Produits totaux</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="total-categories">16</div>
                    <div class="stat-label">Cat√©gories</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="featured-products">12</div>
                    <div class="stat-label">Top du mois</div>
                </div>
            </div>
            
            <!-- Section G√©n√©ration de Produit -->
            <div class="section">
                <h2>üöÄ G√©n√©rer un Nouveau Produit</h2>
                <div class="alert alert-info">
                    <strong>Info :</strong> Cette fonction g√©n√®re un template JSON et une fiche HTML pr√™te √† personnaliser avec vos donn√©es.
                </div>
                
                <form id="product-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="product-name">Nom du produit *</label>
                            <input type="text" id="product-name" placeholder="Ex: Nintendo Switch 2 Pro" required>
                        </div>
                        <div class="form-group">
                            <label for="product-category">Cat√©gorie *</label>
                            <select id="product-category" required>
                                <option value="">S√©lectionner une cat√©gorie</option>
                                <option value="PC GAMING">PC Gaming</option>
                                <option value="CONSOLE">Console</option>
                                <option value="SMARTPHONE">Smartphone</option>
                                <option value="TABLETTE">Tablette</option>
                                <option value="CASQUE AUDIO">Casque Audio</option>
                                <option value="DRONE">Drone</option>
                                <option value="ECRAN TV">√âcran TV</option>
                                <option value="CAMERA">Cam√©ra</option>
                                <option value="MONTRE CONNECTE">Montre Connect√©e</option>
                                <option value="CASQUE VR">Casque VR</option>
                                <option value="IMPRIMANTE 3D">Imprimante 3D</option>
                                <option value="SERVEUR">Serveur</option>
                                <option value="PERIPHERIQUES">P√©riph√©riques</option>
                                <option value="VIDEO PROJECTEUR">Vid√©oprojecteur</option>
                                <option value="BOX INTERNET">Box Internet</option>
                                <option value="TABLEAU INTERACTIF">Tableau Interactif</option>
                            </select>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary">
                        üìÅ G√©n√©rer le Produit Complet
                    </button>
                </form>
                
                <div id="generation-result" style="margin-top: 20px;"></div>
            </div>
            
            <!-- Section Tests -->
            <div class="section">
                <h2>üß™ Tests et Utilitaires</h2>
                
                <button class="btn btn-success" onclick="testProductGeneration()">
                    üéÆ Test avec Nintendo Switch 2 Pro
                </button>
                
                <button class="btn btn-success" onclick="testDroneGeneration()" style="margin-left: 10px;">
                    üöÅ Test avec Nouveau Drone
                </button>
                
                <div id="test-result" style="margin-top: 20px;"></div>
            </div>
        </div>
    </div>

    <script>
        // Fonction pour g√©n√©rer un ID unique
        function generateProductId() {
            // G√©n√©rer un ID entre 1 et 9999
            // En production, il faudrait v√©rifier que l'ID n'existe pas d√©j√†
            const randomId = Math.floor(Math.random() * 9999) + 1;
            return `prod_${randomId}`;
        }
        async function generateUniqueProductId() {
    try {
        const response = await fetch('data/equipements.json');
        const data = await response.json();
        const existingIds = data.equipements.map(p => p.id);
        
        let newId;
        do {
            const randomId = Math.floor(Math.random() * 9999) + 1;
            newId = `prod_${randomId}`;
        } while (existingIds.includes(newId));
        
        return newId;
    } catch {
        // Si erreur, g√©n√©rer un ID al√©atoire simple
        return `prod_${Math.floor(Math.random() * 9999) + 1}`;
    }
}

        // Cr√©er le template JSON pour un nouveau produit
        function createProductTemplate(nom, categorie) {
            const fileName = nom.replace(/[^a-zA-Z0-9]/g, '-').toLowerCase();
            const folder = getCategoryFolder(categorie);
            
            // Sections de base communes √† tous les produits
            let donneesFiche = [
                "√Ä REMPLIR - Description d√©taill√©e du produit.",
                "üí∞ Prix : √Ä D√âFINIR ‚Ç¨",
                "üß© Sp√©cifications mat√©rielles\\n√Ä REMPLIR"
            ];
            
            // Ajouter les sections sp√©cifiques selon la cat√©gorie
            switch(categorie) {
                case 'DRONE':
                    donneesFiche.push("üé• Fonctions vid√©o\\n√Ä REMPLIR");
                    break;
                case 'CONSOLE':
                    donneesFiche.push("üñ•Ô∏è √âcran et affichage\\n√Ä REMPLIR");
                    donneesFiche.push("üïπÔ∏è Contr√¥leurs et interaction\\n√Ä REMPLIR");
                    break;
                case 'TABLETTE':
                    donneesFiche.push("üñ•Ô∏è √âcran et affichage\\n√Ä REMPLIR");
                    donneesFiche.push("üñäÔ∏è Accessoires et interaction\\n√Ä REMPLIR");
                    break;
                case 'SMARTPHONE':
                    donneesFiche.push("üì∏ Appareil photo\\n√Ä REMPLIR");
                    break;
                case 'PC GAMING':
                    donneesFiche.push("üéÆ Fonctions gaming\\n√Ä REMPLIR");
                    break;
                case 'SERVEUR':
                    donneesFiche.push("üñ•Ô∏è Performances et virtualisation\\n√Ä REMPLIR");
                    break;
                case 'PERIPHERIQUES':
                    donneesFiche.push("üñ•Ô∏è Ergonomie et design\\n√Ä REMPLIR");
                    break;
                case 'CASQUE AUDIO':
                    donneesFiche.push("üéß Fonctions audio\\n√Ä REMPLIR");
                    break;
                case 'MONTRE CONNECTE':
                    donneesFiche.push("‚åö Fonctions sport et sant√©\\n√Ä REMPLIR");
                    break;
                case 'ECRAN TV':
                    donneesFiche.push("üñ•Ô∏è Qualit√© d'image\\n√Ä REMPLIR");
                    donneesFiche.push("üéÆ Gaming et fluidit√©\\n√Ä REMPLIR");
                    donneesFiche.push("üé¨ Exp√©rience cin√©ma\\n√Ä REMPLIR");
                    break;
                case 'CAMERA':
                    donneesFiche.push("üé• Fonctions vid√©o\\n√Ä REMPLIR");
                    break;
                case 'VIDEO PROJECTEUR':
                    donneesFiche.push("üñ•Ô∏è Qualit√© d'image\\n√Ä REMPLIR");
                    donneesFiche.push("üéÆ Gaming et fluidit√©\\n√Ä REMPLIR");
                    donneesFiche.push("üé¨ Exp√©rience cin√©ma\\n√Ä REMPLIR");
                    break;
                case 'BOX INTERNET':
                    donneesFiche.push("üì∫ Services TV et multim√©dia\\n√Ä REMPLIR");
                    break;
                case 'TABLEAU INTERACTIF':
                    donneesFiche.push("üñäÔ∏è Fonctions interactives\\n√Ä REMPLIR");
                    break;
                case 'CASQUE VR':
                    donneesFiche.push("üéÆ Fonctions VR et MR\\n√Ä REMPLIR");
                    break;
                case 'IMPRIMANTE 3D':
                    donneesFiche.push("üñ®Ô∏è Fonctions avanc√©es\\n√Ä REMPLIR");
                    break;
            }
            
            // Ajouter les sections finales communes
            donneesFiche.push("üåê Fonctionnalit√©s connect√©es\\n√Ä REMPLIR");
            donneesFiche.push("üéÆ Exp√©rience utilisateur\\n√Ä REMPLIR");
            
            return {
                "nom": nom,
                "categorie": categorie,
                "image": `assets/images/${fileName}.png`,
                "lien": `fiches-produits/${folder}/${fileName}.html`,
                "description": "√Ä REMPLIR - Description courte du produit",
                "top_du_mois": false,
                "prix": "√Ä D√âFINIR ‚Ç¨",
                "fonctionnalites_avancees": [
                    "√Ä REMPLIR - Fonctionnalit√© avanc√©e"
                ],
                "id": generateProductId(),
                "donnees_fiche": donneesFiche
            };
        }

        // Mapping cat√©gories ‚Üí dossiers
        function getCategoryFolder(categorie) {
            const categoryFolders = {
                'PC GAMING': 'pc-gaming',
                'SMARTPHONE': 'smartphone',
                'TABLETTE': 'tablette',
                'CASQUE AUDIO': 'casque-audio',
                'DRONE': 'drone',
                'CONSOLE': 'console',
                'ECRAN TV': 'ecran-tv',
                'CAMERA': 'camera',
                'MONTRE CONNECTE': 'montre-connecte',
                'CASQUE VR': 'casque-vr',
                'IMPRIMANTE 3D': 'imprimante-3d',
                'SERVEUR': 'serveur',
                'PERIPHERIQUES': 'peripheriques',
                'VIDEO PROJECTEUR': 'video-projecteur',
                'BOX INTERNET': 'box-internet',
                'TABLEAU INTERACTIF': 'tableau-interactif'
            };
            return categoryFolders[categorie] || 'autre';
        }

        // Ajouter le produit au JSON existant
        async function addProductToJSON(product) {
            try {
                // Simuler le chargement du JSON existant
                // En production, tu devras charger le vrai fichier
                const existingData = {
                    "equipements": []
                };
                
                // Ajouter le nouveau produit
                existingData.equipements.push(product);
                
                // T√©l√©charger le JSON mis √† jour
                downloadJSON(existingData, 'equipements-updated.json');
                
                console.log('‚úÖ Produit ajout√© au JSON');
                return true;
                
            } catch (error) {
                console.error('‚ùå Erreur ajout JSON:', error);
                const newData = {
                    "equipements": [product]
                };
                downloadJSON(newData, 'equipements-new.json');
                return true;
            }
        }

        // Templates sp√©cifiques par cat√©gorie
        function getCategoryTemplate(categorie) {
            const templates = {
                'DRONE': `<p>üé• Fonctions vid√©o<br>
  √Ä REMPLIR
</p>`,
                'CONSOLE': `<p>üñ•Ô∏è √âcran et affichage<br>
  √Ä REMPLIR
</p>

<p>üïπÔ∏è Contr√¥leurs et interaction<br>
  √Ä REMPLIR
</p>`,
                'TABLETTE': `<p>üñ•Ô∏è √âcran et affichage<br>
  √Ä REMPLIR
</p>

<p>üñäÔ∏è Accessoires et interaction<br>
  √Ä REMPLIR
</p>`,
                'SMARTPHONE': `<p>üì∏ Appareil photo<br>
  √Ä REMPLIR
</p>`,
                'PC GAMING': `<p>üéÆ Fonctions gaming<br>
  √Ä REMPLIR
</p>`,
                'SERVEUR': `<p>üñ•Ô∏è Performances et virtualisation<br>
  √Ä REMPLIR
</p>`,
                'PERIPHERIQUES': `<p>üñ•Ô∏è Ergonomie et design<br>
  √Ä REMPLIR
</p>`,
                'CASQUE AUDIO': `<p>üéß Fonctions audio<br>
  √Ä REMPLIR
</p>`,
                'MONTRE CONNECTE': `<p>‚åö Fonctions sport et sant√©<br>
  √Ä REMPLIR
</p>`,
                'ECRAN TV': `<p>üñ•Ô∏è Qualit√© d'image<br>
  √Ä REMPLIR
</p>

<p>üéÆ Gaming et fluidit√©<br>
  √Ä REMPLIR
</p>

<p>üé¨ Exp√©rience cin√©ma<br>
  √Ä REMPLIR
</p>`,
                'CAMERA': `<p>üé• Fonctions vid√©o<br>
  √Ä REMPLIR
</p>`,
                'VIDEO PROJECTEUR': `<p>üñ•Ô∏è Qualit√© d'image<br>
  √Ä REMPLIR
</p>

<p>üéÆ Gaming et fluidit√©<br>
  √Ä REMPLIR
</p>

<p>üé¨ Exp√©rience cin√©ma<br>
  √Ä REMPLIR
</p>`,
                'BOX INTERNET': `<p>üì∫ Services TV et multim√©dia<br>
  √Ä REMPLIR
</p>`,
                'TABLEAU INTERACTIF': `<p>üñäÔ∏è Fonctions interactives<br>
  √Ä REMPLIR
</p>`,
                'CASQUE VR': `<p>üéÆ Fonctions VR et MR<br>
  √Ä REMPLIR
</p>`,
                'IMPRIMANTE 3D': `<p>üñ®Ô∏è Fonctions avanc√©es<br>
  √Ä REMPLIR
</p>`,
                'DEFAULT': ''
            };
            
            return templates[categorie] || templates['DEFAULT'];
        }

        // G√©n√©rer la page HTML vide
        function generateEmptyHTMLPage(product) {
            const fileName = product.nom.replace(/[^a-zA-Z0-9]/g, '-').toLowerCase();
            const categorySpecificTemplate = getCategoryTemplate(product.categorie);
            
            const htmlContent = `<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>${product.nom}</title>
  <link rel="stylesheet" href="../../assets/css/styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Manrope&family=Montserrat&display=swap" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

  <div class="entete">
    <img src="../../assets/images/gaming.png" alt="Gaming">
    <a href="../../top-du-mois.html">Retour √† la vitrine</a>
  </div>

  <h1>${product.nom}</h1>
  
  <p class="description">√Ä REMPLIR - Description rapide du produit.</p>
  
  <div class="gallery">
    <img src="../../assets/images/placeholder.png" alt="${product.nom}" class="img-centree">
  </div>
  <div class="lightbox" id="lightbox">
    <img id="lightbox-img" src="" alt="Zoom" />
  </div>
  
  <div id="badge-top-mois"></div>

  <!-- Les paragraphes seront remplis dynamiquement -->
  <div id="product-content">
    <!-- Le contenu sera inject√© ici par JavaScript -->
  </div>

  <script>
    const g = document.querySelector(".gallery img");
    const l = document.getElementById("lightbox");
    const z = document.getElementById("lightbox-img");
    if (g) {
      g.addEventListener("click", () => { l.style.display = "flex"; z.src = g.src; });
      l.addEventListener("click", () => l.style.display = "none");
    }

    const nomProduit = document.querySelector("h1").textContent.trim();

    // Charger et afficher TOUTES les donn√©es depuis le JSON
    fetch("../../data/equipements.json")
      .then(res => res.json())
      .then(data => {
        const produit = data.equipements ? 
          data.equipements.find(p => p.nom === nomProduit) : 
          data.find(p => p.nom === nomProduit);
          
        if (produit) {
          console.log("Produit trouv√©:", produit);
          
          // Badge top du mois
          if (produit.top_du_mois) {
            document.getElementById("badge-top-mois").innerHTML = \`
              <div style="background:#ffde59;padding:8px;margin-bottom:10px;text-align:center;border-radius:8px;">
                ‚≠ê Ce produit est en vedette ce mois-ci !
              </div>\`;
          }
          
          // Mettre √† jour la description
          const description = document.querySelector('.description');
          if (description && produit.description) {
            description.textContent = produit.description;
          }
          
          // Mettre √† jour l'image
          if (produit.image) {
            const img = document.querySelector('.gallery img');
            if (img) {
              img.src = '../../' + produit.image;
              img.alt = produit.nom;
            }
          }
          
          // IMPORTANT : Cr√©er dynamiquement tous les paragraphes depuis donnees_fiche
          const contentDiv = document.getElementById('product-content');
          if (contentDiv && produit.donnees_fiche && produit.donnees_fiche.length > 0) {
            // Vider le contenu existant
            contentDiv.innerHTML = '';
            
            // Cr√©er un paragraphe pour chaque donn√©e (sauf la premi√®re qui est la description)
            produit.donnees_fiche.forEach((donnee, index) => {
              if (index > 0) { // Skip la premi√®re ligne (description)
                const p = document.createElement('p');
                p.innerHTML = donnee.replace(/\\\\n/g, '<br>').replace(/\\n/g, '<br>');
                contentDiv.appendChild(p);
              }
            });
          } else {
            // Si pas de donn√©es, afficher le template par d√©faut
            const contentDiv = document.getElementById('product-content');
            contentDiv.innerHTML = \`
              <p>üí∞ Prix : √Ä D√âFINIR ‚Ç¨</p>
              <p>üß© Sp√©cifications mat√©rielles<br>√Ä REMPLIR</p>
              ${categorySpecificTemplate}
              <p>üåê Fonctionnalit√©s connect√©es<br>√Ä REMPLIR</p>
              <p>üéÆ Exp√©rience utilisateur<br>√Ä REMPLIR</p>
            \`;
          }
        } else {
          console.log("Produit non trouv√© dans le JSON");
          // Afficher le contenu par d√©faut si le produit n'est pas trouv√©
          const contentDiv = document.getElementById('product-content');
          contentDiv.innerHTML = \`
            <p>üí∞ Prix : √Ä D√âFINIR ‚Ç¨</p>
            <p>üß© Sp√©cifications mat√©rielles<br>√Ä REMPLIR</p>
            ${categorySpecificTemplate}
            <p>üåê Fonctionnalit√©s connect√©es<br>√Ä REMPLIR</p>
            <p>üéÆ Exp√©rience utilisateur<br>√Ä REMPLIR</p>
          \`;
        }
      })
      .catch(err => {
        console.error("Erreur chargement JSON :", err);
        // En cas d'erreur, afficher le contenu par d√©faut
        const contentDiv = document.getElementById('product-content');
        contentDiv.innerHTML = \`
          <p>üí∞ Prix : √Ä D√âFINIR ‚Ç¨</p>
          <p>üß© Sp√©cifications mat√©rielles<br>√Ä REMPLIR</p>
          ${categorySpecificTemplate}
          <p>üåê Fonctionnalit√©s connect√©es<br>√Ä REMPLIR</p>
          <p>üéÆ Exp√©rience utilisateur<br>√Ä REMPLIR</p>
        \`;
      });
  <\/script>
  
  <footer class="footer">
    <img src="../../assets/images/banniere-pied.png" alt="Banni√®re" class="footer-banner">
    <div class="footer-links">
      <div class="footer-item">
        <img src="../../assets/images/logo-blanc.png" alt="Accueil" class="footer-icon">
        <a href="../../index.html">Accueil</a>
      </div>
      <div class="footer-item">
        <img src="../../assets/images/logo-dokk-blanc.png" alt="Multibloc" class="footer-icon">
        <a href="equipements.html">√âquipements</a>
      </div>
    </div>
  </footer>

</body>
<script src="../../assets/js/utils.js"><\/script>
</html>`;

            // T√©l√©charger le fichier HTML
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${fileName}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            console.log('‚úÖ Page HTML g√©n√©r√©e:', `${fileName}.html`);
            return `${fileName}.html`;
        }

        // Fonction pour t√©l√©charger le JSON
        function downloadJSON(data, filename) {
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            console.log('‚úÖ JSON t√©l√©charg√©:', filename);
        }

        // FONCTION PRINCIPALE
        async function generateCompleteProduct(nom, categorie) {
            try {
                console.log(`üöÄ G√©n√©ration de ${nom} (${categorie})`);
                
                // 1. Cr√©er le template JSON
                const productTemplate = createProductTemplate(nom, categorie);
                console.log('‚úÖ Template JSON cr√©√©:', productTemplate);
                
                // 2. Ajouter au JSON existant
                await addProductToJSON(productTemplate);
                
                // 3. G√©n√©rer la page HTML vide
                const htmlFile = generateEmptyHTMLPage(productTemplate);
                
                return { 
                    success: true, 
                    htmlFile: htmlFile, 
                    product: nom 
                };
                
            } catch (error) {
                console.error('‚ùå Erreur g√©n√©ration compl√®te:', error);
                throw error;
            }
        }

        // Gestionnaire du formulaire
        document.getElementById('product-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const nom = document.getElementById('product-name').value.trim();
            const categorie = document.getElementById('product-category').value;
            const resultDiv = document.getElementById('generation-result');
            
            if (!nom || !categorie) {
                resultDiv.innerHTML = '<div class="alert alert-danger">‚ùå Veuillez remplir tous les champs obligatoires.</div>';
                return;
            }
            
            resultDiv.innerHTML = '<div class="alert alert-info">‚è≥ G√©n√©ration en cours...</div>';
            
            try {
                const result = await generateCompleteProduct(nom, categorie);
                resultDiv.innerHTML = `
                    <div class="alert alert-success">
                        ‚úÖ <strong>Produit g√©n√©r√© avec succ√®s !</strong><br>
                        üìÑ Fichier JSON mis √† jour : equipements-updated.json<br>
                        üìÑ Page HTML cr√©√©e : ${result.htmlFile}<br>
                        ‚ÑπÔ∏è Les fichiers sont pr√™ts √† √™tre personnalis√©s
                    </div>
                `;
                
                // Reset form
                document.getElementById('product-form').reset();
                
            } catch (error) {
                resultDiv.innerHTML = `<div class="alert alert-danger">‚ùå <strong>Erreur:</strong> ${error.message}</div>`;
            }
        });

        // Tests
        async function testProductGeneration() {
            const resultDiv = document.getElementById('test-result');
            resultDiv.innerHTML = '<div class="alert alert-info">‚è≥ Test Nintendo Switch 2 Pro...</div>';
            
            try {
                const result = await generateCompleteProduct("Nintendo Switch 2 Pro", "CONSOLE");
                resultDiv.innerHTML = `
                    <div class="alert alert-success">
                        ‚úÖ <strong>Test r√©ussi !</strong> Nintendo Switch 2 Pro g√©n√©r√©<br>
                        üìÑ HTML: ${result.htmlFile}
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `<div class="alert alert-danger">‚ùå Test √©chou√©: ${error.message}</div>`;
            }
        }

        async function testDroneGeneration() {
            const resultDiv = document.getElementById('test-result');
            resultDiv.innerHTML = '<div class="alert alert-info">‚è≥ Test Drone X-Pro 2025...</div>';
            
            try {
                const result = await generateCompleteProduct("Drone X-Pro 2025", "DRONE");
                resultDiv.innerHTML = `
                    <div class="alert alert-success">
                        ‚úÖ <strong>Test r√©ussi !</strong> Drone X-Pro 2025 g√©n√©r√©<br>
                        üìÑ HTML: ${result.htmlFile}
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `<div class="alert alert-danger">‚ùå Test √©chou√©: ${error.message}</div>`;
            }
        }

        console.log('‚úÖ Interface d\'administration charg√©e !');
    </script>
</body>
</html>
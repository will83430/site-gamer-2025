<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bonnes Pratiques - Site Gamer 2025</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=Orbitron:wght@500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="wiki-styles.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Poppins', Tahoma, Geneva, Verdana, sans-serif; background: #0f0f1e; color: #e0e0e0; line-height: 1.6; }
        .header { background: linear-gradient(135deg, #1a1a2a 0%, #121220 100%); border-bottom: 2px solid #d4ff00; padding: 50px 20px; text-align: center; box-shadow: 0 0 30px rgba(212, 255, 0, 0.2); }
        .header h1 { font-size: 3em; display: inline-block; min-width: max-content; margin-bottom: 10px; }
        .header p { font-size: 1.2em; opacity: 0.9; }
        .nav { background: rgba(212, 255, 0, 0.1); padding: 15px 20px; border-bottom: 1px solid #d4ff00; position: sticky; top: 0; z-index: 100; backdrop-filter: blur(10px); }
        .nav a { color: #d4ff00; text-decoration: none; margin-right: 25px; transition: all 0.3s; font-weight: 500; display: inline-flex; align-items: center; gap: 8px; }
        .nav a:hover { color: #6bff6b; transform: translateY(-2px); }
        .container { max-width: 1200px; margin: 0 auto; padding: 40px 20px; }
        .section { margin-bottom: 50px; background: linear-gradient(145deg, #2a2a40, #1f1f35); border: 2px solid #667eea; border-radius: 15px; padding: 30px; }
        .section h2 { color: #d4ff00; margin-bottom: 20px; font-size: 2em; }
        .section h3 { color: #2ecc71; margin: 25px 0 15px; font-size: 1.4em; }
        .practice { background: rgba(46, 204, 113, 0.1); border-left: 4px solid #2ecc71; padding: 20px; margin: 20px 0; border-radius: 8px; }
        .practice-title { color: #2ecc71; font-weight: 600; margin-bottom: 10px; font-size: 1.1em; }
        .dont { background: rgba(231, 76, 60, 0.1); border-left: 4px solid #e74c3c; padding: 20px; margin: 20px 0; border-radius: 8px; }
        .dont-title { color: #e74c3c; font-weight: 600; margin-bottom: 10px; font-size: 1.1em; }
        code { background: rgba(102, 126, 234, 0.2); padding: 3px 8px; border-radius: 4px; font-family: 'Courier New', monospace; color: #ffd700; }
        pre { background: #1a1a2e; padding: 20px; border-radius: 10px; overflow-x: auto; margin: 15px 0; border: 1px solid #667eea; }
        pre code { background: none; padding: 0; color: #2ecc71; }
        .back-link { display: inline-block; margin-top: 30px; padding: 12px 25px; background: #667eea; display: inline-block; min-width: max-content; border-radius: 8px; text-decoration: none; transition: all 0.3s; }
        .back-link:hover { background: #764ba2; transform: translateY(-2px); }
        .footer { text-align: center; margin-top: 60px; padding: 30px; border-top: 1px solid rgba(102, 126, 234, 0.3); opacity: 0.7; }
    </style>
</head>
<body>
    <div class="header">
        <h1>‚≠ê Bonnes Pratiques</h1>
        <p>Standards et guidelines du Site Gamer 2025</p>
    </div>

    <nav class="nav">
        <a href="wiki.html">üè† Accueil Wiki</a>
        <a href="api-reference.html">üìÅ API</a>
        <a href="database.html">üóÑÔ∏è Base de donn√©es</a>
        <a href="scripts.html">‚öôÔ∏è Scripts</a>
        <a href="troubleshooting.html">üîß D√©pannage</a>
        <a href="changelog.html">üìù Changelog</a>
    </nav>

    <div class="container">
        <div class="section">
            <h2>üóÑÔ∏è Base de donn√©es</h2>

            <h3>Conventions de nommage</h3>
            <div class="practice">
                <div class="practice-title">‚úÖ √Ä FAIRE</div>
                <ul style="margin-left: 20px;">
                    <li>IDs produits : <code>prod_XX</code> (format strict)</li>
                    <li>Cat√©gories : lowercase avec tirets (ex: <code>pc-gaming</code>)</li>
                    <li>Prix : format strict <code>"XXX.XX‚Ç¨"</code></li>
                    <li>Images : nom de fichier uniquement (ex: <code>iphone-15.jpg</code>)</li>
                </ul>
            </div>

            <div class="dont">
                <div class="dont-title">‚ùå √Ä √âVITER</div>
                <ul style="margin-left: 20px;">
                    <li>Cat√©gories avec espaces ou majuscules</li>
                    <li>Chemins absolus dans le champ image</li>
                    <li>Prix sans le symbole ‚Ç¨</li>
                    <li>IDs personnalis√©s non conformes</li>
                </ul>
            </div>

            <h3>Gestion des arrays</h3>
            <div class="practice">
                <div class="practice-title">‚úÖ Format recommand√©</div>
                <pre><code>// fonctionnalites_avancees
["√âcran OLED", "5G", "128 GB"]

// donnees_fiche (JSONB)
[
  {"titre": "Caract√©ristiques", "contenu": "..."},
  {"titre": "Performance", "contenu": "..."}
]</code></pre>
            </div>

            <h3>Backups r√©guliers</h3>
            <div class="practice">
                <div class="practice-title">‚úÖ Routine de backup</div>
                <pre><code># Backup quotidien
pg_dump -U postgres gamer_2025 > backup_$(date +%Y%m%d).sql

# Avant modification majeure
pg_dump -U postgres gamer_2025 > backup_avant_modification.sql</code></pre>
            </div>
        </div>

        <div class="section">
            <h2>üîå API</h2>

            <h3>Mise √† jour des produits</h3>
            <div class="practice">
                <div class="practice-title">‚úÖ Workflow PUT correct</div>
                <pre><code>// 1. R√©cup√©rer le produit complet
const product = await fetch('/api/produits/prod_50')
  .then(r => r.json());

// 2. Modifier
product.top_du_mois = true;

// 3. PUT avec TOUT l'objet
await fetch('/api/produits/prod_50', {
  method: 'PUT',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify(product)
});</code></pre>
            </div>

            <div class="dont">
                <div class="dont-title">‚ùå Ne PAS faire de PUT partiel</div>
                <pre><code>// ‚ùå INCORRECT - Va √©craser les autres champs avec null
await fetch('/api/produits/prod_50', {
  method: 'PUT',
  body: JSON.stringify({ top_du_mois: true })
});</code></pre>
            </div>

            <h3>Gestion des erreurs</h3>
            <div class="practice">
                <div class="practice-title">‚úÖ Toujours v√©rifier les r√©ponses</div>
                <pre><code>const response = await fetch('/api/produits/prod_50');

if (!response.ok) {
  console.error('Erreur:', response.status);
  throw new Error('Produit introuvable');
}

const product = await response.json();</code></pre>
            </div>
        </div>

        <div class="section">
            <h2>üìÑ G√©n√©ration de fiches</h2>

            <h3>Avant g√©n√©ration</h3>
            <div class="practice">
                <div class="practice-title">‚úÖ Checklist</div>
                <ul style="margin-left: 20px;">
                    <li>‚úì V√©rifier que <code>donnees_fiche</code> est complet</li>
                    <li>‚úì S'assurer que <code>fonctionnalites_avancees</code> existe</li>
                    <li>‚úì Valider le format du prix</li>
                    <li>‚úì V√©rifier que l'image existe</li>
                    <li>‚úì Confirmer que la cat√©gorie correspond √† un dossier</li>
                </ul>
            </div>

            <h3>R√©g√©n√©ration</h3>
            <div class="practice">
                <div class="practice-title">‚úÖ Quand r√©g√©n√©rer</div>
                <ul style="margin-left: 20px;">
                    <li>Apr√®s modification du template HTML</li>
                    <li>Apr√®s mise √† jour des styles CSS</li>
                    <li>Apr√®s modification des donn√©es produit</li>
                    <li>Apr√®s ajout de nouvelles fonctionnalit√©s</li>
                </ul>
                <pre><code># Tout r√©g√©n√©rer
node scripts/regenerate-all-fiches.js

# Seulement les tops du mois
node scripts/regenerate-fiches-top.js</code></pre>
            </div>
        </div>

        <div class="section">
            <h2>‚öôÔ∏è Scripts</h2>

            <h3>Avant d'ex√©cuter un script</h3>
            <div class="practice">
                <div class="practice-title">‚úÖ Checklist s√©curit√©</div>
                <ul style="margin-left: 20px;">
                    <li>‚úì Faire un backup de la DB</li>
                    <li>‚úì Lire le code du script</li>
                    <li>‚úì Comprendre ce qu'il va faire</li>
                    <li>‚úì V√©rifier les credentials DB</li>
                    <li>‚úì Tester sur un √©chantillon si possible</li>
                </ul>
            </div>

            <h3>Apr√®s modifications</h3>
            <div class="practice">
                <div class="practice-title">‚úÖ V√©rification post-script</div>
                <pre><code>node scripts/verify-database-state.js</code></pre>
            </div>

            <h3>Scripts de normalisation</h3>
            <div class="dont">
                <div class="dont-title">‚ö†Ô∏è Attention</div>
                <p style="margin-left: 20px;">Les scripts de normalisation modifient directement la DB. Toujours faire un backup avant !</p>
            </div>
        </div>

        <div class="section">
            <h2>üé® Frontend</h2>

            <h3>Build des assets</h3>
            <div class="practice">
                <div class="practice-title">‚úÖ Workflow recommand√©</div>
                <pre><code># 1. Modifier les sources
# frontend/public/assets/css/*.css
# frontend/public/assets/js/*.js

# 2. Build
npm run build:css
npm run build:js

# 3. Tester localement
npm start

# 4. Commit
git add frontend/public/assets/
git commit -m "Update minified assets"</code></pre>
            </div>

            <div class="dont">
                <div class="dont-title">‚ùå Ne pas modifier directement les fichiers .min</div>
                <p style="margin-left: 20px;">Les fichiers <code>.min.css</code> et <code>.min.js</code> sont g√©n√©r√©s automatiquement. Modifiez toujours les sources.</p>
            </div>

            <h3>Images</h3>
            <div class="practice">
                <div class="practice-title">‚úÖ Organisation</div>
                <ul style="margin-left: 20px;">
                    <li>Toutes les images dans <code>frontend/public/assets/images/</code></li>
                    <li>Nommage : lowercase, tirets, pas d'espaces</li>
                    <li>Format : JPEG pour photos, PNG pour logos/ic√¥nes</li>
                    <li>Taille : max 500 KB par image</li>
                    <li>Placeholder : <code>placeholder.png</code> toujours pr√©sent</li>
                </ul>
            </div>
        </div>

        <div class="section">
            <h2>üîß D√©veloppement</h2>

            <h3>Mode d√©veloppement</h3>
            <div class="practice">
                <div class="practice-title">‚úÖ Utiliser nodemon</div>
                <pre><code>npm run dev  # Auto-restart sur modification</code></pre>
            </div>

            <h3>Tests avant commit</h3>
            <div class="practice">
                <div class="practice-title">‚úÖ Checklist</div>
                <ul style="margin-left: 20px;">
                    <li>‚úì Le serveur d√©marre sans erreur</li>
                    <li>‚úì Les endpoints API r√©pondent</li>
                    <li>‚úì Les fiches se g√©n√®rent correctement</li>
                    <li>‚úì La DB est coh√©rente</li>
                    <li>‚úì Les assets sont build√©s</li>
                </ul>
            </div>

            <h3>Git workflow</h3>
            <div class="practice">
                <div class="practice-title">‚úÖ Messages de commit</div>
                <pre><code># Format recommand√©
feat: Add new product category
fix: Correct price format in database
docs: Update API documentation
refactor: Normalize smartphone data
chore: Update dependencies</code></pre>
            </div>
        </div>

        <div class="section">
            <h2>üöÄ Production</h2>

            <h3>Avant d√©ploiement</h3>
            <div class="practice">
                <div class="practice-title">‚úÖ Checklist production</div>
                <ul style="margin-left: 20px;">
                    <li>‚úì Backup complet de la DB</li>
                    <li>‚úì Build des assets minifi√©s</li>
                    <li>‚úì Test de tous les endpoints</li>
                    <li>‚úì V√©rification des credentials</li>
                    <li>‚úì Variables d'environnement configur√©es</li>
                    <li>‚úì HTTPS activ√©</li>
                    <li>‚úì CORS configur√© correctement</li>
                </ul>
            </div>

            <h3>Monitoring</h3>
            <div class="practice">
                <div class="practice-title">‚úÖ √Ä surveiller</div>
                <ul style="margin-left: 20px;">
                    <li>Temps de r√©ponse API</li>
                    <li>Taux d'erreur 500</li>
                    <li>Utilisation DB (connexions, taille)</li>
                    <li>Espace disque (logs, fiches)</li>
                    <li>M√©moire Node.js</li>
                </ul>
            </div>
        </div>

        <div class="section">
            <h2>üìö Documentation</h2>

            <h3>Code comments</h3>
            <div class="practice">
                <div class="practice-title">‚úÖ Commenter intelligemment</div>
                <pre><code>// ‚úÖ BON : Explique le POURQUOI
// Utilise slugToTitreAffiche car certains produits
// n'ont pas de titre_affiche d√©fini
const displayTitle = product.titre_affiche || slugToTitreAffiche(slug);

// ‚ùå MAUVAIS : R√©p√®te le code
// Assigne displayTitle
const displayTitle = product.titre_affiche || slug;</code></pre>
            </div>

            <h3>README et Wiki</h3>
            <div class="practice">
                <div class="practice-title">‚úÖ Tenir √† jour</div>
                <ul style="margin-left: 20px;">
                    <li>Mettre √† jour apr√®s chaque feature majeure</li>
                    <li>Ajouter des exemples concrets</li>
                    <li>Documenter les cas d'erreur</li>
                    <li>Inclure des captures d'√©cran si pertinent</li>
                </ul>
            </div>
        </div>

        <a href="wiki.html" class="back-link">‚Üê Retour au Wiki</a>
    </div>

    <div class="footer">
        <p>‚≠ê Bonnes Pratiques - Site Gamer 2025</p>
        <p>Derni√®re mise √† jour : 26 d√©cembre 2025</p>
    </div>
</body>
</html>

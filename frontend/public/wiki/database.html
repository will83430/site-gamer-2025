<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Base de Donn√©es - Site Gamer 2025</title>    <link rel="stylesheet" href="wiki-styles.css">    <style>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=Orbitron:wght@500;600;700;800&display=swap" rel="stylesheet">
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Poppins', Tahoma, Geneva, Verdana, sans-serif; background: #0f0f1e; color: #e0e0e0; line-height: 1.6; }
        .header { background: linear-gradient(135deg, #1a1a2a 0%, #121220 100%); border-bottom: 2px solid #d4ff00; padding: 50px 20px; text-align: center; box-shadow: 0 0 30px rgba(212, 255, 0, 0.2); }
        .header h1 { font-size: 3em; display: inline-block; min-width: max-content; margin-bottom: 10px; }
        .header p { font-size: 1.2em; opacity: 0.9; }
        .nav { background: rgba(212, 255, 0, 0.1); padding: 15px 20px; border-bottom: 1px solid #d4ff00; position: sticky; top: 0; z-index: 100; backdrop-filter: blur(10px); }
        .nav a { color: #d4ff00; text-decoration: none; margin-right: 25px; transition: all 0.3s; font-weight: 500; display: inline-flex; align-items: center; gap: 8px; }
        .nav a:hover { color: #6bff6b; transform: translateY(-2px); }
        .container { max-width: 1200px; margin: 0 auto; padding: 40px 20px; }
        .section { margin-bottom: 50px; background: linear-gradient(145deg, #2a2a40, #1f1f35); border: 2px solid #667eea; border-radius: 15px; padding: 30px; }
        .section h2 { color: #d4ff00; margin-bottom: 20px; font-size: 2em; display: flex; align-items: center; gap: 10px; }
        .section h3 { color: #2ecc71; margin: 25px 0 15px; font-size: 1.4em; }
        .table-info { background: rgba(212, 255, 0, 0.1); border-left: 4px solid #667eea; padding: 20px; margin: 20px 0; border-radius: 8px; }
        .table-name { font-size: 1.3em; color: #ffd700; font-family: 'Courier New', monospace; margin-bottom: 10px; }
        .schema-table { width: 100%; border-collapse: collapse; margin: 15px 0; }
        .schema-table th { background: rgba(102, 126, 234, 0.2); padding: 12px; text-align: left; color: #d4ff00; border-bottom: 2px solid #667eea; }
        .schema-table td { padding: 10px 12px; border-bottom: 1px solid rgba(102, 126, 234, 0.1); }
        .schema-table tr:hover { background: rgba(102, 126, 234, 0.05); }
        .col-name { font-family: 'Courier New', monospace; color: #ffd700; }
        .col-type { color: #3498db; font-size: 0.9em; }
        .col-constraint { color: #e74c3c; font-size: 0.85em; }
        code { background: rgba(102, 126, 234, 0.2); padding: 3px 8px; border-radius: 4px; font-family: 'Courier New', monospace; color: #ffd700; }
        pre { background: #1a1a2e; padding: 20px; border-radius: 10px; overflow-x: auto; margin: 15px 0; border: 1px solid #667eea; }
        pre code { background: none; padding: 0; color: #2ecc71; }
        .info { background: rgba(52, 152, 219, 0.1); border-left: 4px solid #3498db; padding: 15px; margin: 15px 0; border-radius: 5px; }
        .info-title { color: #3498db; font-weight: 600; margin-bottom: 10px; }
        .warning { background: rgba(243, 156, 18, 0.1); border-left: 4px solid #f39c12; padding: 15px; margin: 15px 0; border-radius: 5px; }
        .warning-title { color: #f39c12; font-weight: 600; margin-bottom: 10px; }
        .toc { background: rgba(212, 255, 0, 0.1); padding: 20px; border-radius: 10px; margin-bottom: 30px; }
        .toc h3 { color: #d4ff00; margin-bottom: 15px; }
        .toc ul { list-style: none; }
        .toc li { margin: 8px 0; }
        .toc a { color: #e0e0e0; text-decoration: none; transition: color 0.3s; }
        .toc a:hover { color: #d4ff00; }
        .back-link { display: inline-block; margin-top: 30px; padding: 12px 25px; background: #667eea; display: inline-block; min-width: max-content; border-radius: 8px; text-decoration: none; transition: all 0.3s; }
        .back-link:hover { background: #764ba2; transform: translateY(-2px); }
        .footer { text-align: center; margin-top: 60px; padding: 30px; border-top: 1px solid rgba(102, 126, 234, 0.3); opacity: 0.7; }
        .badge { display: inline-block; padding: 4px 12px; border-radius: 15px; font-size: 0.8em; margin: 0 5px; font-weight: 600; }
        .badge-pk { background: rgba(231, 76, 60, 0.3); color: #e74c3c; }
        .badge-fk { background: rgba(243, 156, 18, 0.3); color: #f39c12; }
        .badge-unique { background: rgba(155, 89, 182, 0.3); color: #9b59b6; }
        .badge-array { background: rgba(52, 152, 219, 0.3); color: #3498db; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üêò Base de Donn√©es</h1>
        <p>Sch√©ma PostgreSQL du Site Gamer 2025</p>
    </div>

    <nav class="nav">
        <a href="wiki.html">üè† Accueil Wiki</a>
        <a href="api-reference.html">üìÅ API</a>
        <a href="database.html">üóÑÔ∏è Base de donn√©es</a>
        <a href="scripts.html">‚öôÔ∏è Scripts</a>
        <a href="troubleshooting.html">üîß D√©pannage</a>
        <a href="changelog.html">üìù Changelog</a>
    </nav>

    <div class="container">
        <div class="toc">
            <h3>üìë Table des mati√®res</h3>
            <ul>
                <li><a href="#overview">Vue d'ensemble</a></li>
                <li><a href="#produits">Table produits</a></li>
                <li><a href="#categories">Table categories</a></li>
                <li><a href="#tendances">Table tendances</a></li>
                <li><a href="#contenus">Tables de contenus par cat√©gorie</a></li>
                <li><a href="#queries">Requ√™tes SQL courantes</a></li>
            </ul>
        </div>

        <!-- Overview -->
        <div class="section" id="overview">
            <h2>üìä Vue d'ensemble</h2>
            
            <div class="info">
                <div class="info-title">‚ÑπÔ∏è Informations de connexion</div>
                <ul style="margin-left: 20px;">
                    <li><strong>Base de donn√©es :</strong> <code>gamer_2025</code></li>
                    <li><strong>Utilisateur :</strong> <code>XXXXXX</code></li>
                    <li><strong>Mot de passe :</strong> <code>XXXXXX</code></li>
                    <li><strong>Version PostgreSQL :</strong> 14+</li>
                    <li><strong>Port par d√©faut :</strong> XXXX</li>
                </ul>
            </div>

            <h3>Tables principales</h3>
            <ul style="margin: 15px 0; margin-left: 20px; opacity: 0.85;">
                <li><code>produits</code> - Catalogue complet des produits technologiques (61+ produits)</li>
                <li><code>categories</code> - Liste des 16 cat√©gories de produits</li>
                <li><code>tendances</code> - Tendances technologiques et march√©</li>
                <li><code>actualites_*</code> - Actualit√©s par cat√©gorie (smartphone, tablette, etc.)</li>
                <li><code>technologies_*</code> - Technologies √©mergentes par cat√©gorie</li>
                <li><code>tendances_marche_*</code> - Tendances du march√© par cat√©gorie</li>
                <li><code>insights_*</code> - Analyses et insights par cat√©gorie</li>
                <li><code>predictions_*</code> - Pr√©dictions et prospectives par cat√©gorie</li>
            </ul>

            <div class="warning">
                <div class="warning-title">‚ö†Ô∏è Important</div>
                <p>Tous les scripts du projet utilisent les m√™mes credentials. Si vous modifiez les informations de connexion, pensez √† mettre √† jour :</p>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li><code>server.js</code></li>
                    <li>Tous les scripts dans <code>scripts/</code></li>
                </ul>
            </div>
        </div>

        <!-- Table produits -->
        <div class="section" id="produits">
            <h2>üì¶ Table produits</h2>
            <p>Table principale contenant tous les produits technologiques du catalogue.</p>

            <div class="table-info">
                <div class="table-name">produits</div>
                <p style="opacity: 0.85; margin-bottom: 15px;">Stocke les informations compl√®tes de chaque produit avec m√©tadonn√©es enrichies.</p>

                <table class="schema-table">
                    <thead>
                        <tr>
                            <th>Colonne</th>
                            <th>Type</th>
                            <th>Contraintes</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="col-name">id</span></td>
                            <td><span class="col-type">VARCHAR(20)</span></td>
                            <td><span class="badge badge-pk">PK</span></td>
                            <td>Identifiant unique au format prod_XX</td>
                        </tr>
                        <tr>
                            <td><span class="col-name">nom</span></td>
                            <td><span class="col-type">TEXT</span></td>
                            <td><span class="col-constraint">NOT NULL</span></td>
                            <td>Nom complet du produit</td>
                        </tr>
                        <tr>
                            <td><span class="col-name">categorie</span></td>
                            <td><span class="col-type">TEXT</span></td>
                            <td></td>
                            <td>Cat√©gorie (lowercase, avec tirets)</td>
                        </tr>
                        <tr>
                            <td><span class="col-name">prix</span></td>
                            <td><span class="col-type">TEXT</span></td>
                            <td></td>
                            <td>Prix au format "XXX.XX‚Ç¨"</td>
                        </tr>
                        <tr>
                            <td><span class="col-name">description_courte</span></td>
                            <td><span class="col-type">TEXT</span></td>
                            <td></td>
                            <td>Description courte pour les listes</td>
                        </tr>
                        <tr>
                            <td><span class="col-name">image</span></td>
                            <td><span class="col-type">TEXT</span></td>
                            <td></td>
                            <td>Nom du fichier image (sans chemin)</td>
                        </tr>
                        <tr>
                            <td><span class="col-name">lien</span></td>
                            <td><span class="col-type">TEXT</span></td>
                            <td></td>
                            <td>Chemin vers la fiche HTML</td>
                        </tr>
                        <tr>
                            <td><span class="col-name">titre_affiche</span></td>
                            <td><span class="col-type">TEXT</span></td>
                            <td></td>
                            <td>Titre alternatif pour affichage</td>
                        </tr>
                        <tr>
                            <td><span class="col-name">top_du_mois</span></td>
                            <td><span class="col-type">BOOLEAN</span></td>
                            <td></td>
                            <td>Produit vedette du mois</td>
                        </tr>
                        <tr>
                            <td><span class="col-name">fonctionnalites_avancees</span></td>
                            <td><span class="col-type">TEXT[]</span></td>
                            <td><span class="badge badge-array">ARRAY</span></td>
                            <td>Liste des fonctionnalit√©s</td>
                        </tr>
                        <tr>
                            <td><span class="col-name">donnees_fiche</span></td>
                            <td><span class="col-type">JSONB</span></td>
                            <td><span class="badge badge-array">JSONB</span></td>
                            <td>Donn√©es structur√©es pour la fiche</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>Structure du champ donnees_fiche</h3>
            <p>Array JSONB avec sections de contenu :</p>
            <pre><code>[
  {
    "titre": "Caract√©ristiques techniques",
    "contenu": "D√©tails des sp√©cifications..."
  },
  {
    "titre": "Performance",
    "contenu": "Analyse des performances..."
  }
]</code></pre>

            <h3>Format des IDs</h3>
            <div class="info">
                <div class="info-title">‚ÑπÔ∏è Convention de nommage</div>
                <p>Les IDs suivent le format <code>prod_XX</code> o√π XX est un nombre s√©quentiel :</p>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li><code>prod_1</code> √† <code>prod_49</code> : Produits initiaux</li>
                    <li><code>prod_50</code> √† <code>prod_61</code> : Produits de d√©cembre 2025</li>
                    <li>Auto-incr√©ment√© lors de POST via calcul du max ID + 1</li>
                </ul>
            </div>

            <h3>R√®gles importantes</h3>
            <div class="warning">
                <div class="warning-title">‚ö†Ô∏è Conventions √† respecter</div>
                <ul style="margin-left: 20px;">
                    <li><strong>categorie :</strong> Toujours en lowercase, espaces remplac√©s par tirets (ex: "pc-gaming")</li>
                    <li><strong>prix :</strong> Format strict "XXX.XX‚Ç¨" (ex: "1479.00‚Ç¨")</li>
                    <li><strong>image :</strong> Nom de fichier UNIQUEMENT, pas de chemin (ex: "iphone-15-pro-max.jpg")</li>
                    <li><strong>lien :</strong> Chemin relatif depuis la racine (ex: "/fiches/smartphone/iphone-15-pro-max.html")</li>
                    <li><strong>fonctionnalites_avancees :</strong> Array PostgreSQL ou JSON array</li>
                    <li><strong>donnees_fiche :</strong> JSONB avec structure [{titre, contenu}, ...]</li>
                </ul>
            </div>
        </div>

        <!-- Table categories -->
        <div class="section" id="categories">
            <h2>üè∑Ô∏è Table categories</h2>
            
            <div class="table-info">
                <div class="table-name">categories</div>
                <p style="opacity: 0.85; margin-bottom: 15px;">Liste des 16 cat√©gories de produits technologiques.</p>

                <table class="schema-table">
                    <thead>
                        <tr>
                            <th>Colonne</th>
                            <th>Type</th>
                            <th>Contraintes</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="col-name">id</span></td>
                            <td><span class="col-type">SERIAL</span></td>
                            <td><span class="badge badge-pk">PK</span></td>
                            <td>ID auto-incr√©ment√©</td>
                        </tr>
                        <tr>
                            <td><span class="col-name">nom</span></td>
                            <td><span class="col-type">TEXT</span></td>
                            <td><span class="badge badge-unique">UNIQUE</span></td>
                            <td>Nom de la cat√©gorie (lowercase)</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>Cat√©gories disponibles</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0;">
                <div style="background: rgba(212, 255, 0, 0.1); padding: 15px; border-radius: 8px; text-align: center;">smartphone</div>
                <div style="background: rgba(212, 255, 0, 0.1); padding: 15px; border-radius: 8px; text-align: center;">tablette</div>
                <div style="background: rgba(212, 255, 0, 0.1); padding: 15px; border-radius: 8px; text-align: center;">pc-gaming</div>
                <div style="background: rgba(212, 255, 0, 0.1); padding: 15px; border-radius: 8px; text-align: center;">console</div>
                <div style="background: rgba(212, 255, 0, 0.1); padding: 15px; border-radius: 8px; text-align: center;">peripheriques</div>
                <div style="background: rgba(212, 255, 0, 0.1); padding: 15px; border-radius: 8px; text-align: center;">casque-audio</div>
                <div style="background: rgba(212, 255, 0, 0.1); padding: 15px; border-radius: 8px; text-align: center;">casque-vr</div>
                <div style="background: rgba(212, 255, 0, 0.1); padding: 15px; border-radius: 8px; text-align: center;">montre-connectee</div>
                <div style="background: rgba(212, 255, 0, 0.1); padding: 15px; border-radius: 8px; text-align: center;">camera</div>
                <div style="background: rgba(212, 255, 0, 0.1); padding: 15px; border-radius: 8px; text-align: center;">drone</div>
                <div style="background: rgba(212, 255, 0, 0.1); padding: 15px; border-radius: 8px; text-align: center;">ecran-tv</div>
                <div style="background: rgba(212, 255, 0, 0.1); padding: 15px; border-radius: 8px; text-align: center;">video-projecteur</div>
                <div style="background: rgba(212, 255, 0, 0.1); padding: 15px; border-radius: 8px; text-align: center;">imprimante-3d</div>
                <div style="background: rgba(212, 255, 0, 0.1); padding: 15px; border-radius: 8px; text-align: center;">serveur</div>
                <div style="background: rgba(212, 255, 0, 0.1); padding: 15px; border-radius: 8px; text-align: center;">box-internet</div>
                <div style="background: rgba(212, 255, 0, 0.1); padding: 15px; border-radius: 8px; text-align: center;">tableau-interactif</div>
            </div>
        </div>

        <!-- Table tendances -->
        <div class="section" id="tendances">
            <h2>üî• Table tendances</h2>
            
            <div class="table-info">
                <div class="table-name">tendances</div>
                <p style="opacity: 0.85; margin-bottom: 15px;">Tendances technologiques globales.</p>

                <table class="schema-table">
                    <thead>
                        <tr>
                            <th>Colonne</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="col-name">id</span></td>
                            <td><span class="col-type">SERIAL</span></td>
                            <td>ID auto-incr√©ment√©</td>
                        </tr>
                        <tr>
                            <td><span class="col-name">titre</span></td>
                            <td><span class="col-type">TEXT</span></td>
                            <td>Titre de la tendance</td>
                        </tr>
                        <tr>
                            <td><span class="col-name">categorie</span></td>
                            <td><span class="col-type">TEXT</span></td>
                            <td>Cat√©gorie associ√©e</td>
                        </tr>
                        <tr>
                            <td><span class="col-name">description</span></td>
                            <td><span class="col-type">TEXT</span></td>
                            <td>Description d√©taill√©e</td>
                        </tr>
                        <tr>
                            <td><span class="col-name">tags</span></td>
                            <td><span class="col-type">TEXT</span></td>
                            <td>Tags (format {a,b,c} PostgreSQL)</td>
                        </tr>
                        <tr>
                            <td><span class="col-name">date_publication</span></td>
                            <td><span class="col-type">TIMESTAMP</span></td>
                            <td>Date de publication</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Tables de contenus -->
        <div class="section" id="contenus">
            <h2>üì∞ Tables de contenus par cat√©gorie</h2>
            <p>Chaque cat√©gorie dispose de 5 tables de contenus sp√©cialis√©es.</p>

            <h3>Structure des tables</h3>
            <p>Pour chaque cat√©gorie (ex: smartphone, tablette), les tables suivantes existent :</p>

            <div style="display: grid; gap: 20px; margin: 20px 0;">
                <div class="table-info">
                    <div class="table-name">actualites_{categorie}</div>
                    <p>Actualit√©s et news de la cat√©gorie</p>
                </div>

                <div class="table-info">
                    <div class="table-name">technologies_{categorie}</div>
                    <p>Technologies √©mergentes et innovations</p>
                </div>

                <div class="table-info">
                    <div class="table-name">tendances_marche_{categorie}</div>
                    <p>Tendances et √©volutions du march√©</p>
                </div>

                <div class="table-info">
                    <div class="table-name">insights_{categorie}</div>
                    <p>Analyses approfondies et insights</p>
                </div>

                <div class="table-info">
                    <div class="table-name">predictions_{categorie}</div>
                    <p>Pr√©dictions et prospectives</p>
                </div>
            </div>

            <h3>Sch√©ma commun</h3>
            <p>Toutes ces tables partagent la m√™me structure :</p>
            <table class="schema-table" style="margin-top: 15px;">
                <thead>
                    <tr>
                        <th>Colonne</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="col-name">id</span></td>
                        <td><span class="col-type">SERIAL</span></td>
                        <td>ID auto-incr√©ment√©</td>
                    </tr>
                    <tr>
                        <td><span class="col-name">titre</span></td>
                        <td><span class="col-type">TEXT</span></td>
                        <td>Titre du contenu</td>
                    </tr>
                    <tr>
                        <td><span class="col-name">contenu</span></td>
                        <td><span class="col-type">TEXT</span></td>
                        <td>Contenu d√©taill√©</td>
                    </tr>
                    <tr>
                        <td><span class="col-name">tags</span></td>
                        <td><span class="col-type">TEXT[]</span></td>
                        <td>Tags (array PostgreSQL ou {a,b,c})</td>
                    </tr>
                    <tr>
                        <td><span class="col-name">date_publication</span></td>
                        <td><span class="col-type">TIMESTAMP</span></td>
                        <td>Date de publication</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Requ√™tes SQL courantes -->
        <div class="section" id="queries">
            <h2>üíª Requ√™tes SQL courantes</h2>

            <h3>Produits</h3>
            <pre><code>-- Tous les produits
SELECT * FROM produits;

-- Produits d'une cat√©gorie
SELECT * FROM produits WHERE categorie = 'smartphone';

-- Tops du mois
SELECT * FROM produits WHERE top_du_mois = true;

-- Compter les produits par cat√©gorie
SELECT categorie, COUNT(*) as total 
FROM produits 
GROUP BY categorie 
ORDER BY total DESC;

-- Recherche par nom
SELECT * FROM produits WHERE nom ILIKE '%iphone%';</code></pre>

            <h3>Insertion avec gestion des arrays</h3>
            <pre><code>-- Insertion d'un produit
INSERT INTO produits (
  id, nom, categorie, prix, description_courte, 
  image, lien, fonctionnalites_avancees, donnees_fiche
) VALUES (
  'prod_62',
  'Galaxy S25 Ultra',
  'smartphone',
  '1399.00‚Ç¨',
  'Le nouveau fleuron Samsung',
  'galaxy-s25-ultra.jpg',
  '/fiches/smartphone/galaxy-s25-ultra.html',
  ARRAY['√âcran AMOLED 6.8"', 'Snapdragon 8 Gen 4'],
  '[{"titre": "Caract√©ristiques", "contenu": "..."}]'::jsonb
);</code></pre>

            <h3>Mise √† jour</h3>
            <pre><code>-- Marquer comme top du mois
UPDATE produits 
SET top_du_mois = true 
WHERE id = 'prod_50';

-- Changer le prix
UPDATE produits 
SET prix = '1499.00‚Ç¨' 
WHERE id = 'prod_50';

-- Ajouter une fonctionnalit√©
UPDATE produits 
SET fonctionnalites_avancees = 
  array_append(fonctionnalites_avancees, 'Nouvelle fonctionnalit√©')
WHERE id = 'prod_50';</code></pre>

            <h3>Nettoyage et v√©rification</h3>
            <pre><code>-- V√©rifier les images manquantes
SELECT id, nom, image 
FROM produits 
WHERE image IS NULL OR image = '';

-- V√©rifier les cat√©gories invalides
SELECT DISTINCT categorie 
FROM produits 
WHERE categorie NOT IN (SELECT nom FROM categories);

-- Produits sans donnees_fiche
SELECT id, nom 
FROM produits 
WHERE donnees_fiche IS NULL 
   OR jsonb_array_length(donnees_fiche) = 0;

-- Compter les produits par top_du_mois
SELECT top_du_mois, COUNT(*) 
FROM produits 
GROUP BY top_du_mois;</code></pre>

            <h3>Backup et restauration</h3>
            <pre><code>-- Backup
pg_dump -U postgres gamer_2025 > backup_$(date +%Y%m%d).sql

-- Restauration
psql -U postgres gamer_2025 < backup_20251226.sql

-- Backup d'une seule table
pg_dump -U postgres -t produits gamer_2025 > produits_backup.sql</code></pre>
        </div>

        <a href="wiki.html" class="back-link">‚Üê Retour au Wiki</a>
    </div>

    <div class="footer">
        <p>üêò Base de Donn√©es - Site Gamer 2025</p>
        <p>Derni√®re mise √† jour : 26 d√©cembre 2025</p>
    </div>
</body>
</html>

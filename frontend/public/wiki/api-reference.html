<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R√©f√©rence API - Site Gamer 2025</title>
    <link rel="stylesheet" href="wiki-styles.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #0f0f1e; color: #e0e0e0; line-height: 1.6; }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 50px 20px; text-align: center; box-shadow: 0 5px 30px rgba(102, 126, 234, 0.4); }
        .header h1 { font-size: 3em; color: white; margin-bottom: 10px; }
        .header p { font-size: 1.2em; opacity: 0.9; }
        .nav { background: rgba(102, 126, 234, 0.1); padding: 15px 20px; border-bottom: 1px solid #667eea; position: sticky; top: 0; z-index: 100; backdrop-filter: blur(10px); }
        .nav a { color: #667eea; text-decoration: none; margin-right: 25px; transition: all 0.3s; font-weight: 500; display: inline-flex; align-items: center; gap: 8px; }
        .nav a:hover { color: #764ba2; transform: translateY(-2px); }
        .container { max-width: 1200px; margin: 0 auto; padding: 40px 20px; }
        .section { margin-bottom: 50px; background: linear-gradient(145deg, #2a2a40, #1f1f35); border: 2px solid #667eea; border-radius: 15px; padding: 30px; }
        .section h2 { color: #667eea; margin-bottom: 20px; font-size: 2em; display: flex; align-items: center; gap: 10px; }
        .section h3 { color: #2ecc71; margin: 25px 0 15px; font-size: 1.4em; }
        .endpoint { background: rgba(102, 126, 234, 0.1); border-left: 4px solid #2ecc71; padding: 20px; margin: 20px 0; border-radius: 8px; }
        .endpoint-header { display: flex; align-items: center; gap: 15px; margin-bottom: 15px; flex-wrap: wrap; }
        .method { font-weight: 700; padding: 6px 12px; border-radius: 6px; font-size: 0.9em; }
        .method-get { background: #2ecc71; color: white; }
        .method-post { background: #3498db; color: white; }
        .method-put { background: #f39c12; color: white; }
        .method-delete { background: #e74c3c; color: white; }
        .endpoint-path { font-family: 'Courier New', monospace; color: #ffd700; font-size: 1.1em; }
        .endpoint-desc { opacity: 0.85; margin: 10px 0; }
        .param-table { width: 100%; border-collapse: collapse; margin: 15px 0; }
        .param-table th { background: rgba(102, 126, 234, 0.2); padding: 12px; text-align: left; color: #667eea; border-bottom: 2px solid #667eea; }
        .param-table td { padding: 10px 12px; border-bottom: 1px solid rgba(102, 126, 234, 0.1); }
        .param-table tr:hover { background: rgba(102, 126, 234, 0.05); }
        .param-name { font-family: 'Courier New', monospace; color: #ffd700; }
        .param-type { color: #3498db; font-size: 0.9em; }
        .param-required { color: #e74c3c; font-size: 0.8em; }
        .param-optional { color: #95a5a6; font-size: 0.8em; }
        code { background: rgba(102, 126, 234, 0.2); padding: 3px 8px; border-radius: 4px; font-family: 'Courier New', monospace; color: #ffd700; }
        pre { background: #1a1a2e; padding: 20px; border-radius: 10px; overflow-x: auto; margin: 15px 0; border: 1px solid #667eea; }
        pre code { background: none; padding: 0; color: #2ecc71; }
        .example { background: rgba(52, 152, 219, 0.1); border-left: 4px solid #3498db; padding: 15px; margin: 15px 0; border-radius: 5px; }
        .example-title { color: #3498db; font-weight: 600; margin-bottom: 10px; }
        .response { background: rgba(46, 204, 113, 0.1); border-left: 4px solid #2ecc71; padding: 15px; margin: 15px 0; border-radius: 5px; }
        .response-title { color: #2ecc71; font-weight: 600; margin-bottom: 10px; }
        .toc { background: rgba(102, 126, 234, 0.1); padding: 20px; border-radius: 10px; margin-bottom: 30px; }
        .toc h3 { color: #667eea; margin-bottom: 15px; }
        .toc ul { list-style: none; }
        .toc li { margin: 8px 0; }
        .toc a { color: #e0e0e0; text-decoration: none; transition: color 0.3s; }
        .toc a:hover { color: #667eea; }
        .back-link { display: inline-block; margin-top: 30px; padding: 12px 25px; background: #667eea; color: white; border-radius: 8px; text-decoration: none; transition: all 0.3s; }
        .back-link:hover { background: #764ba2; transform: translateY(-2px); }
        .footer { text-align: center; margin-top: 60px; padding: 30px; border-top: 1px solid rgba(102, 126, 234, 0.3); opacity: 0.7; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üîå R√©f√©rence API</h1>
        <p>Documentation compl√®te des API REST du Site Gamer 2025</p>
    </div>

    <nav class="nav">
        <a href="wiki.html">üè† Accueil Wiki</a>
        <a href="api-reference.html">üìÅ API</a>
        <a href="database.html">üóÑÔ∏è Base de donn√©es</a>
        <a href="scripts.html">‚öôÔ∏è Scripts</a>
        <a href="troubleshooting.html">üîß D√©pannage</a>
        <a href="changelog.html">üìù Changelog</a>
    </nav>

    <div class="container">
        <div class="toc">
            <h3>üìë Table des mati√®res</h3>
            <ul>
                <li><a href="#produits">üì¶ API Produits</a></li>
                <li><a href="#fiches">üìÑ API Fiches</a></li>
                <li><a href="#tendances">üî• API Tendances</a></li>
                <li><a href="#contenus">üì∞ API Contenus par Cat√©gorie</a></li>
                <li><a href="#config">‚öôÔ∏è API Configuration</a></li>
            </ul>
        </div>

        <!-- API Produits -->
        <div class="section" id="produits">
            <h2>üì¶ API Produits</h2>
            <p>Gestion CRUD compl√®te des produits technologiques.</p>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-get">GET</span>
                    <span class="endpoint-path">/api/produits</span>
                </div>
                <div class="endpoint-desc">R√©cup√®re tous les produits ou filtre par cat√©gorie.</div>
                
                <h4>Param√®tres Query</h4>
                <table class="param-table">
                    <tr>
                        <th>Nom</th>
                        <th>Type</th>
                        <th>Requis</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td><span class="param-name">categorie</span></td>
                        <td><span class="param-type">string</span></td>
                        <td><span class="param-optional">optionnel</span></td>
                        <td>Filtre par cat√©gorie (ex: smartphone, tablette, pc-gaming)</td>
                    </tr>
                </table>

                <div class="example">
                    <div class="example-title">üìù Exemple de requ√™te</div>
                    <pre><code>// Tous les produits
GET http://localhost:3000/api/produits

// Produits d'une cat√©gorie
GET http://localhost:3000/api/produits?categorie=smartphone</code></pre>
                </div>

                <div class="response">
                    <div class="response-title">‚úÖ R√©ponse (200 OK)</div>
                    <pre><code>[
  {
    "id": "prod_50",
    "nom": "iPhone 15 Pro Max",
    "categorie": "smartphone",
    "prix": "1479.00‚Ç¨",
    "description_courte": "Le smartphone le plus avanc√©...",
    "image": "iphone-15-pro-max.jpg",
    "image_url": "/assets/images/iphone-15-pro-max.jpg",
    "lien": "/fiches/smartphone/iphone-15-pro-max.html",
    "titre_affiche": "iPhone 15 Pro Max",
    "top_du_mois": true,
    "fonctionnalites_avancees": [...],
    "donnees_fiche": [...]
  }
]</code></pre>
                </div>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-get">GET</span>
                    <span class="endpoint-path">/api/produits/:id</span>
                </div>
                <div class="endpoint-desc">R√©cup√®re un produit sp√©cifique par son ID.</div>
                
                <h4>Param√®tres URL</h4>
                <table class="param-table">
                    <tr>
                        <th>Nom</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td><span class="param-name">id</span></td>
                        <td><span class="param-type">string</span></td>
                        <td>ID du produit (ex: prod_50)</td>
                    </tr>
                </table>

                <div class="example">
                    <div class="example-title">üìù Exemple</div>
                    <pre><code>GET http://localhost:3000/api/produits/prod_50</code></pre>
                </div>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-post">POST</span>
                    <span class="endpoint-path">/api/produits</span>
                </div>
                <div class="endpoint-desc">Cr√©e un nouveau produit. L'ID est auto-g√©n√©r√© (prochain prod_*).</div>
                
                <h4>Body (JSON)</h4>
                <table class="param-table">
                    <tr>
                        <th>Champ</th>
                        <th>Type</th>
                        <th>Requis</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td><span class="param-name">nom</span></td>
                        <td><span class="param-type">string</span></td>
                        <td><span class="param-required">requis</span></td>
                        <td>Nom du produit</td>
                    </tr>
                    <tr>
                        <td><span class="param-name">categorie</span></td>
                        <td><span class="param-type">string</span></td>
                        <td><span class="param-required">requis</span></td>
                        <td>Cat√©gorie du produit</td>
                    </tr>
                    <tr>
                        <td><span class="param-name">prix</span></td>
                        <td><span class="param-type">string</span></td>
                        <td><span class="param-required">requis</span></td>
                        <td>Prix au format "XXX.XX‚Ç¨"</td>
                    </tr>
                    <tr>
                        <td><span class="param-name">description_courte</span></td>
                        <td><span class="param-type">string</span></td>
                        <td><span class="param-required">requis</span></td>
                        <td>Description courte</td>
                    </tr>
                    <tr>
                        <td><span class="param-name">image</span></td>
                        <td><span class="param-type">string</span></td>
                        <td><span class="param-optional">optionnel</span></td>
                        <td>Nom du fichier image (sans chemin)</td>
                    </tr>
                    <tr>
                        <td><span class="param-name">titre_affiche</span></td>
                        <td><span class="param-type">string</span></td>
                        <td><span class="param-optional">optionnel</span></td>
                        <td>Titre alternatif pour affichage</td>
                    </tr>
                    <tr>
                        <td><span class="param-name">top_du_mois</span></td>
                        <td><span class="param-type">boolean</span></td>
                        <td><span class="param-optional">optionnel</span></td>
                        <td>Produit vedette du mois</td>
                    </tr>
                    <tr>
                        <td><span class="param-name">fonctionnalites_avancees</span></td>
                        <td><span class="param-type">array</span></td>
                        <td><span class="param-optional">optionnel</span></td>
                        <td>Tableau de fonctionnalit√©s</td>
                    </tr>
                    <tr>
                        <td><span class="param-name">donnees_fiche</span></td>
                        <td><span class="param-type">array</span></td>
                        <td><span class="param-optional">optionnel</span></td>
                        <td>Donn√©es pour la fiche d√©taill√©e</td>
                    </tr>
                </table>

                <div class="example">
                    <div class="example-title">üìù Exemple</div>
                    <pre><code>POST http://localhost:3000/api/produits
Content-Type: application/json

{
  "nom": "Galaxy S25 Ultra",
  "categorie": "smartphone",
  "prix": "1399.00‚Ç¨",
  "description_courte": "Le nouveau fleuron Samsung...",
  "image": "galaxy-s25-ultra.jpg",
  "top_du_mois": false,
  "fonctionnalites_avancees": [
    "√âcran AMOLED 6.8\"",
    "Snapdragon 8 Gen 4"
  ],
  "donnees_fiche": [
    {
      "titre": "Caract√©ristiques",
      "contenu": "..."
    }
  ]
}</code></pre>
                </div>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-put">PUT</span>
                    <span class="endpoint-path">/api/produits/:id</span>
                </div>
                <div class="endpoint-desc">Met √† jour un produit existant. <strong>IMPORTANT :</strong> Requiert TOUS les champs (pas de mise √† jour partielle).</div>
                
                <div class="example">
                    <div class="example-title">üìù Workflow recommand√©</div>
                    <pre><code>// 1. GET pour r√©cup√©rer le produit complet
const product = await fetch('/api/produits/prod_50').then(r => r.json());

// 2. Modifier les champs souhait√©s
product.top_du_mois = true;
product.prix = "1499.00‚Ç¨";

// 3. PUT avec l'objet complet
await fetch('/api/produits/prod_50', {
  method: 'PUT',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify(product)
});</code></pre>
                </div>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-delete">DELETE</span>
                    <span class="endpoint-path">/api/produits/:id</span>
                </div>
                <div class="endpoint-desc">Supprime un produit et sa fiche HTML associ√©e.</div>
                
                <div class="response">
                    <div class="response-title">‚úÖ R√©ponse</div>
                    <pre><code>{
  "message": "Produit 'iPhone 15 Pro Max' supprim√© avec succ√®s"
}</code></pre>
                </div>
            </div>
        </div>

        <!-- API Fiches -->
        <div class="section" id="fiches">
            <h2>üìÑ API Fiches</h2>
            <p>G√©n√©ration et gestion des fiches HTML d√©taill√©es des produits.</p>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-post">POST</span>
                    <span class="endpoint-path">/api/generate-fiche/:id</span>
                </div>
                <div class="endpoint-desc">G√©n√®re une fiche HTML compl√®te pour un produit.</div>
                
                <div class="example">
                    <div class="example-title">üìù Exemple</div>
                    <pre><code>POST http://localhost:3000/api/generate-fiche/prod_50</code></pre>
                </div>

                <div class="response">
                    <div class="response-title">‚úÖ R√©ponse</div>
                    <pre><code>{
  "message": "Fiche g√©n√©r√©e avec succ√®s",
  "path": "/fiches/smartphone/iphone-15-pro-max.html"
}</code></pre>
                </div>

                <p style="margin-top: 15px; opacity: 0.85;">
                    <strong>Chemin de sortie :</strong> <code>fiches/{categorie-slug}/{produit-slug}.html</code><br>
                    <strong>Template :</strong> Utilise <code>styles.min.css</code> et <code>fiche-produit.min.js</code><br>
                    <strong>Donn√©es :</strong> Extrait <code>titre_affiche || nom</code>, <code>donnees_fiche</code>, <code>fonctionnalites_avancees</code>
                </p>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-get">GET</span>
                    <span class="endpoint-path">/api/preview-fiche/:id</span>
                </div>
                <div class="endpoint-desc">Pr√©visualise le contenu HTML d'une fiche sans la sauvegarder.</div>
                
                <p style="margin-top: 15px; opacity: 0.85;">
                    Tente plusieurs chemins de recherche dans l'ordre :<br>
                    1. <code>/fiches/{categorie}/{slug}.html</code><br>
                    2. <code>/fiches/{categorie-slug}/{slug}.html</code><br>
                    3. <code>/fiches/{categorie}/{nom}.html</code>
                </p>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-delete">DELETE</span>
                    <span class="endpoint-path">/api/fiches/:id</span>
                </div>
                <div class="endpoint-desc">Supprime la fiche HTML d'un produit (utilise le champ <code>lien</code> stock√© en DB).</div>
            </div>
        </div>

        <!-- API Tendances -->
        <div class="section" id="tendances">
            <h2>üî• API Tendances</h2>
            <p>Gestion des tendances technologiques.</p>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-get">GET</span>
                    <span class="endpoint-path">/api/tendances</span>
                </div>
                <div class="endpoint-desc">Liste toutes les tendances.</div>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-get">GET</span>
                    <span class="endpoint-path">/api/tendances/:id</span>
                </div>
                <div class="endpoint-desc">R√©cup√®re une tendance sp√©cifique.</div>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-post">POST</span>
                    <span class="endpoint-path">/api/tendances</span>
                </div>
                <div class="endpoint-desc">Cr√©e une nouvelle tendance.</div>
                
                <h4>Champs</h4>
                <ul style="margin: 15px 0; margin-left: 20px;">
                    <li><code>titre</code> - Titre de la tendance</li>
                    <li><code>categorie</code> - Cat√©gorie associ√©e (lowercase)</li>
                    <li><code>description</code> - Description d√©taill√©e</li>
                    <li><code>tags</code> - Array de tags (converti en format PostgreSQL {a,b,c})</li>
                    <li><code>date_publication</code> - Date au format ISO</li>
                </ul>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-put">PUT</span>
                    <span class="endpoint-path">/api/tendances/:id</span>
                </div>
                <div class="endpoint-desc">Met √† jour une tendance existante.</div>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-delete">DELETE</span>
                    <span class="endpoint-path">/api/tendances/:id</span>
                </div>
                <div class="endpoint-desc">Supprime une tendance.</div>
            </div>
        </div>

        <!-- API Contenus par Cat√©gorie -->
        <div class="section" id="contenus">
            <h2>üì∞ API Contenus par Cat√©gorie</h2>
            <p>Gestion des actualit√©s, technologies, insights, pr√©dictions et tendances du march√© par cat√©gorie.</p>

            <h3>Endpoints disponibles pour chaque type</h3>
            <p>Pour chaque cat√©gorie (smartphone, tablette, pc-gaming, etc.) :</p>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-get">GET</span>
                    <span class="endpoint-path">/api/:categorie/actualites</span>
                </div>
                <div class="endpoint-desc">Liste des actualit√©s d'une cat√©gorie.</div>
                <div class="example">
                    <div class="example-title">üìù Exemple</div>
                    <pre><code>GET http://localhost:3000/api/smartphone/actualites</code></pre>
                </div>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-get">GET</span>
                    <span class="endpoint-path">/api/:categorie/technologies</span>
                </div>
                <div class="endpoint-desc">Technologies √©mergentes de la cat√©gorie.</div>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-get">GET</span>
                    <span class="endpoint-path">/api/:categorie/marche</span>
                </div>
                <div class="endpoint-desc">Tendances du march√©.</div>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-get">GET</span>
                    <span class="endpoint-path">/api/:categorie/insights</span>
                </div>
                <div class="endpoint-desc">Analyses et insights.</div>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-get">GET</span>
                    <span class="endpoint-path">/api/:categorie/predictions</span>
                </div>
                <div class="endpoint-desc">Pr√©dictions et prospectives.</div>
            </div>

            <h3>CRUD complet pour chaque type</h3>
            <p>Chaque type (actualites, technologies, etc.) dispose des endpoints CRUD :</p>
            <ul style="margin: 15px 0 15px 20px; opacity: 0.85;">
                <li><code>GET /api/:categorie/:type</code> - Liste</li>
                <li><code>GET /api/:categorie/:type/:id</code> - D√©tail</li>
                <li><code>POST /api/:categorie/:type</code> - Cr√©ation</li>
                <li><code>PUT /api/:categorie/:type/:id</code> - Mise √† jour</li>
                <li><code>DELETE /api/:categorie/:type/:id</code> - Suppression</li>
            </ul>
        </div>

        <!-- API Configuration -->
        <div class="section" id="config">
            <h2>‚öôÔ∏è API Configuration</h2>
            
            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-get">GET</span>
                    <span class="endpoint-path">/api/llm-config</span>
                </div>
                <div class="endpoint-desc">Configuration du mod√®le LLM utilis√©.</div>
                
                <div class="response">
                    <div class="response-title">‚úÖ R√©ponse</div>
                    <pre><code>{
  "model": "gpt-5",
  "gpt5Enabled": false,
  "gpt5Rollout": 0
}</code></pre>
                </div>

                <p style="margin-top: 15px; opacity: 0.85;">
                    Lit les variables d'environnement :<br>
                    ‚Ä¢ <code>OPENAI_MODEL</code> - Mod√®le par d√©faut<br>
                    ‚Ä¢ <code>GPT5_ENABLED</code> - Activation GPT-5<br>
                    ‚Ä¢ <code>GPT5_ROLLOUT</code> - Pourcentage de d√©ploiement
                </p>
            </div>
        </div>

        <a href="wiki.html" class="back-link">‚Üê Retour au Wiki</a>
    </div>

    <div class="footer">
        <p>üîå R√©f√©rence API - Site Gamer 2025</p>
        <p>Derni√®re mise √† jour : 26 d√©cembre 2025</p>
    </div>
</body>
</html>

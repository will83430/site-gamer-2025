<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Architecture Site Gamer 2025 - Architecture Modulaire</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .metrics {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
            font-size: 0.9em;
        }
        
        .metric {
            background: rgba(255,255,255,0.1);
            padding: 10px 20px;
            border-radius: 8px;
        }
        
        .metric strong {
            color: #3498db;
            font-size: 1.2em;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        .btn.active {
            transform: scale(1.05);
        }
        
        .btn-frontend { background: #4A90E2; color: white; }
        .btn-backend { background: #27AE60; color: white; }
        .btn-database { background: #F1C40F; color: #333; }
        .btn-scripts { background: #E67E22; color: white; }
        .btn-tests { background: #66BB6A; color: white; }
        .btn-all { background: #9B59B6; color: white; }
        
        .flow-container {
            display: flex;
            padding: 40px;
            gap: 40px;
            overflow-x: auto;
            min-height: 600px;
            position: relative;
        }
        
        .connections-svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .flow-column {
            position: relative;
            z-index: 2;
        }
        
        .connection-line {
            stroke: #95a5a6;
            stroke-width: 2;
            fill: none;
            opacity: 0.3;
            transition: all 0.3s;
        }
        
        .connection-line.active {
            stroke: #3498db;
            stroke-width: 3;
            opacity: 1;
            animation: dash 1s linear infinite;
        }
        
        .connection-arrow {
            fill: #95a5a6;
            opacity: 0.3;
            transition: all 0.3s;
        }
        
        .connection-arrow.active {
            fill: #3498db;
            opacity: 1;
        }
        
        @keyframes dash {
            to {
                stroke-dashoffset: -20;
            }
        }
        
        .flow-column {
            min-width: 280px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .column-title {
            font-size: 1.3em;
            font-weight: bold;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            color: white;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .frontend-title { background: linear-gradient(135deg, #4A90E2, #357ABD); }
        .backend-title { background: linear-gradient(135deg, #27AE60, #1E8449); }
        .database-title { background: linear-gradient(135deg, #F1C40F, #D4AC0D); }
        .scripts-title { background: linear-gradient(135deg, #E67E22, #BA4A00); }
        .output-title { background: linear-gradient(135deg, #95A5A6, #7F8C8D); }
        
        .node {
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .node::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }
        
        .node:hover::before {
            left: 100%;
        }
        
        .node:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }
        
        .node.hidden {
            display: none;
        }
        
        .node-title {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 5px;
        }
        
        .node-desc {
            font-size: 0.9em;
            opacity: 0.8;
        }
        
        /* Couleurs des nodes */
        .node-html { background: linear-gradient(135deg, #4A90E2, #357ABD); color: white; }
        .node-js { background: linear-gradient(135deg, #7B68EE, #5B48CC); color: white; }
        .node-admin { background: linear-gradient(135deg, #E24A4A, #C0392B); color: white; }
        .node-api { background: linear-gradient(135deg, #2ECC71, #27AE60); color: white; }
        .node-api-special { background: linear-gradient(135deg, #F39C12, #D68910); color: white; }
        .node-table { background: linear-gradient(135deg, #F9E79F, #F4D03F); color: #333; }
        .node-script { background: linear-gradient(135deg, #E67E22, #CA6F1E); color: white; }
        .node-output { background: linear-gradient(135deg, #95A5A6, #7F8C8D); color: white; }
        
        .legend {
            padding: 30px;
            background: #f8f9fa;
            border-top: 2px solid #e9ecef;
        }
        
        .legend h3 {
            margin-bottom: 20px;
            color: #2c3e50;
            font-size: 1.5em;
        }
        
        .legend-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .legend-color {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            flex-shrink: 0;
        }
        
        .legend-text {
            flex: 1;
        }
        
        .legend-label {
            font-weight: bold;
            color: #2c3e50;
        }
        
        .legend-desc {
            font-size: 0.9em;
            color: #7f8c8d;
        }
        
        .flow-info {
            text-align: center;
            padding: 20px;
            background: #e8f5e9;
            border-radius: 10px;
            margin: 0 40px 20px;
        }
        
        .flow-info h3 {
            color: #27AE60;
            margin-bottom: 10px;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .node.active {
            animation: pulse 1s infinite;
        }
        
        @media (max-width: 768px) {
            .flow-container {
                flex-direction: column;
                padding: 20px;
            }
            
            .flow-column {
                min-width: 100%;
            }
            
            header h1 {
                font-size: 1.8em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ðŸŽ® Architecture Site Gamer 2025</h1>
            <p>Visualisation des flux de donnÃ©es - Frontend â†’ Backend â†’ Database</p>
        </header>
        
        <div class="controls">
            <button class="btn btn-all active" onclick="filterLayer('all')">Tous les flux</button>
            <button class="btn btn-frontend" onclick="filterLayer('frontend')">Frontend</button>
            <button class="btn btn-backend" onclick="filterLayer('backend')">Backend / API</button>
            <button class="btn btn-database" onclick="filterLayer('database')">Database</button>
            <button class="btn btn-scripts" onclick="filterLayer('scripts')">Scripts</button>
        </div>
        
        <div class="flow-info">
            <h3>Flux de donnÃ©es</h3>
            <p>HTML â†’ JavaScript â†’ API REST â†’ PostgreSQL | Scripts â†’ API/DB â†’ Fichiers gÃ©nÃ©rÃ©s</p>
        </div>
        
        <div class="flow-container">
            <svg class="connections-svg" id="connectionsSvg"></svg>
            
            <!-- Frontend Column -->
            <div class="flow-column layer-frontend layer-all">
                <div class="column-title frontend-title">Frontend</div>
                
                <div class="node node-html" data-connects="fichesJS">
                    <div class="node-title">index.html</div>
                    <div class="node-desc">Page d'accueil</div>
                </div>
                
                <div class="node node-html" data-connects="fichesJS">
                    <div class="node-title">top-du-mois.html</div>
                    <div class="node-desc">Tops produits</div>
                </div>
                
                <div class="node node-admin" data-connects="adminJS">
                    <div class="node-title">admin-gestion-produits.html</div>
                    <div class="node-desc">Interface admin</div>
                </div>
                
                <div class="node node-admin" data-connects="adminTendJS">
                    <div class="node-title">admin-tendances.html</div>
                    <div class="node-desc">Admin tendances</div>
                </div>
                
                <div class="node node-html" data-connects="ficheJS">
                    <div class="node-title">fiches/*.html</div>
                    <div class="node-desc">DÃ©tails produits</div>
                </div>
            </div>
            
            <!-- JavaScript Column -->
            <div class="flow-column layer-frontend layer-all">
                <div class="column-title frontend-title">JavaScript</div>
                
                <div class="node node-js" id="fichesJS" data-connects="apiProduits">
                    <div class="node-title">fiches.js</div>
                    <div class="node-desc">Gestion liste produits</div>
                </div>
                
                <div class="node node-js" id="ficheJS" data-connects="apiProduits">
                    <div class="node-title">fiche-produit.js</div>
                    <div class="node-desc">DÃ©tail produit</div>
                </div>
                
                <div class="node node-js" id="adminJS" data-connects="apiProduitsCRUD,apiGenFiche">
                    <div class="node-title">admin-gestion-produits.js</div>
                    <div class="node-desc">CRUD produits + gÃ©nÃ©ration fiches</div>
                </div>
                
                <div class="node node-js" id="adminTendJS" data-connects="apiTendances">
                    <div class="node-title">admin-tendances.js</div>
                    <div class="node-desc">CRUD tendances</div>
                </div>
            </div>
            
            <!-- Backend API Column -->
            <div class="flow-column layer-backend layer-all">
                <div class="column-title backend-title">Backend API</div>
                
                <div class="node node-api" id="apiProduits" data-connects="tableProduits">
                    <div class="node-title">GET /api/produits</div>
                    <div class="node-desc">Liste produits</div>
                </div>
                
                <div class="node node-api" id="apiProduitsCRUD" data-connects="tableProduits">
                    <div class="node-title">POST/PUT/DELETE /api/produits</div>
                    <div class="node-desc">CRUD produits</div>
                </div>
                
                <div class="node node-api-special" id="apiGenFiche" data-connects="tableProduits,ficheOutput">
                    <div class="node-title">POST /api/generate-fiche/:id</div>
                    <div class="node-desc">GÃ©nÃ¨re fichier HTML</div>
                </div>
                
                <div class="node node-api" id="apiTendances" data-connects="tableTendances">
                    <div class="node-title">GET /api/:categorie/*</div>
                    <div class="node-desc">ActualitÃ©s, technologies, marchÃ©</div>
                </div>
            </div>
            
            <!-- Database Column -->
            <div class="flow-column layer-database layer-all">
                <div class="column-title database-title">PostgreSQL</div>
                
                <div class="node node-table" id="tableProduits">
                    <div class="node-title">ðŸ“¦ produits</div>
                    <div class="node-desc">Catalogue complet</div>
                </div>
                
                <div class="node node-table" id="tableTendances">
                    <div class="node-title">ðŸ“Š actualites</div>
                    <div class="node-desc">ActualitÃ©s secteur</div>
                </div>
                
                <div class="node node-table">
                    <div class="node-title">ðŸ’¡ technologies</div>
                    <div class="node-desc">Technologies Ã©mergentes</div>
                </div>
                
                <div class="node node-table">
                    <div class="node-title">ðŸ“ˆ marche</div>
                    <div class="node-desc">DonnÃ©es marchÃ©</div>
                </div>
                
                <div class="node node-table">
                    <div class="node-title">ðŸ”® predictions</div>
                    <div class="node-desc">PrÃ©visions tech</div>
                </div>
            </div>
            
            <!-- Scripts & Output Column -->
            <div class="flow-column layer-scripts layer-all">
                <div class="column-title scripts-title">Scripts</div>
                
                <div class="node node-script" data-connects="tableProduits">
                    <div class="node-title">add-new-products.js</div>
                    <div class="node-desc">Insert produits â†’ DB</div>
                </div>
                
                <div class="node node-script" data-connects="apiGenFiche">
                    <div class="node-title">generate-all-new-fiches.js</div>
                    <div class="node-desc">HTTP POST â†’ API</div>
                </div>
                
                <div class="node node-script" data-connects="apiGenFiche">
                    <div class="node-title">regenerate-all-fiches.js</div>
                    <div class="node-desc">Loop HTTP POST</div>
                </div>
                
                <div class="node node-script" data-connects="apiProduitsCRUD">
                    <div class="node-title">set-top-decembre.js</div>
                    <div class="node-desc">Toggle top_du_mois</div>
                </div>
                
                <div class="column-title output-title" style="margin-top: 20px;">Sortie</div>
                
                <div class="node node-output" id="ficheOutput">
                    <div class="node-title">ðŸ“„ fiches/*.html</div>
                    <div class="node-desc">Fichiers gÃ©nÃ©rÃ©s statiques</div>
                </div>
            </div>
        </div>
        
        <div class="legend">
            <h3>ðŸŽ¨ LÃ©gende des composants</h3>
            <div class="legend-grid">
                <div class="legend-item">
                    <div class="legend-color" style="background: linear-gradient(135deg, #4A90E2, #357ABD);"></div>
                    <div class="legend-text">
                        <div class="legend-label">Pages HTML</div>
                        <div class="legend-desc">Interface utilisateur</div>
                    </div>
                </div>
                
                <div class="legend-item">
                    <div class="legend-color" style="background: linear-gradient(135deg, #7B68EE, #5B48CC);"></div>
                    <div class="legend-text">
                        <div class="legend-label">JavaScript</div>
                        <div class="legend-desc">Logique frontend</div>
                    </div>
                </div>
                
                <div class="legend-item">
                    <div class="legend-color" style="background: linear-gradient(135deg, #E24A4A, #C0392B);"></div>
                    <div class="legend-text">
                        <div class="legend-label">Admin</div>
                        <div class="legend-desc">Interfaces administration</div>
                    </div>
                </div>
                
                <div class="legend-item">
                    <div class="legend-color" style="background: linear-gradient(135deg, #2ECC71, #27AE60);"></div>
                    <div class="legend-text">
                        <div class="legend-label">API REST</div>
                        <div class="legend-desc">Endpoints backend</div>
                    </div>
                </div>
                
                <div class="legend-item">
                    <div class="legend-color" style="background: linear-gradient(135deg, #F39C12, #D68910);"></div>
                    <div class="legend-text">
                        <div class="legend-label">GÃ©nÃ©ration</div>
                        <div class="legend-desc">CrÃ©ation fichiers HTML</div>
                    </div>
                </div>
                
                <div class="legend-item">
                    <div class="legend-color" style="background: linear-gradient(135deg, #F9E79F, #F4D03F);"></div>
                    <div class="legend-text">
                        <div class="legend-label">Tables DB</div>
                        <div class="legend-desc">PostgreSQL gamer_2025</div>
                    </div>
                </div>
                
                <div class="legend-item">
                    <div class="legend-color" style="background: linear-gradient(135deg, #E67E22, #CA6F1E);"></div>
                    <div class="legend-text">
                        <div class="legend-label">Scripts Node.js</div>
                        <div class="legend-desc">Maintenance & gÃ©nÃ©ration</div>
                    </div>
                </div>
                
                <div class="legend-item">
                    <div class="legend-color" style="background: linear-gradient(135deg, #95A5A6, #7F8C8D);"></div>
                    <div class="legend-text">
                        <div class="legend-label">Fichiers gÃ©nÃ©rÃ©s</div>
                        <div class="legend-desc">Sortie statique</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        let currentFilter = 'all';
        
        function drawConnections() {
            const svg = document.getElementById('connectionsSvg');
            svg.innerHTML = ''; // Clear existing
            
            const nodes = document.querySelectorAll('.node[data-connects]');
            
            nodes.forEach(node => {
                if (node.offsetParent === null) return; // Skip hidden nodes
                
                const connects = node.dataset.connects;
                if (!connects) return;
                
                const fromRect = node.getBoundingClientRect();
                const containerRect = document.querySelector('.flow-container').getBoundingClientRect();
                
                connects.split(',').forEach(targetId => {
                    const target = document.getElementById(targetId.trim());
                    if (!target || target.offsetParent === null) return;
                    
                    const toRect = target.getBoundingClientRect();
                    
                    // Calculate positions relative to container
                    const x1 = fromRect.right - containerRect.left;
                    const y1 = fromRect.top + fromRect.height / 2 - containerRect.top;
                    const x2 = toRect.left - containerRect.left;
                    const y2 = toRect.top + toRect.height / 2 - containerRect.top;
                    
                    // Create curved path
                    const midX = (x1 + x2) / 2;
                    const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                    const d = `M ${x1} ${y1} Q ${midX} ${y1}, ${midX} ${(y1 + y2) / 2} T ${x2} ${y2}`;
                    
                    path.setAttribute('d', d);
                    path.setAttribute('class', 'connection-line');
                    path.setAttribute('stroke-dasharray', '5,5');
                    path.setAttribute('data-from', node.id || 'unknown');
                    path.setAttribute('data-to', targetId.trim());
                    
                    svg.appendChild(path);
                    
                    // Add arrow
                    const arrow = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
                    const angle = Math.atan2(y2 - y1, x2 - x1);
                    const arrowSize = 8;
                    const arrowX = x2 - 10;
                    const arrowY = y2;
                    
                    const points = [
                        [arrowX, arrowY],
                        [arrowX - arrowSize * Math.cos(angle - Math.PI / 6), arrowY - arrowSize * Math.sin(angle - Math.PI / 6)],
                        [arrowX - arrowSize * Math.cos(angle + Math.PI / 6), arrowY - arrowSize * Math.sin(angle + Math.PI / 6)]
                    ].map(p => p.join(',')).join(' ');
                    
                    arrow.setAttribute('points', points);
                    arrow.setAttribute('class', 'connection-arrow');
                    arrow.setAttribute('data-from', node.id || 'unknown');
                    arrow.setAttribute('data-to', targetId.trim());
                    
                    svg.appendChild(arrow);
                });
            });
        }
        
        function filterLayer(layer) {
            currentFilter = layer;
            
            // Update button states
            document.querySelectorAll('.btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Show/hide columns
            document.querySelectorAll('.flow-column').forEach(col => {
                if (layer === 'all') {
                    col.style.display = 'flex';
                } else {
                    if (col.classList.contains(`layer-${layer}`)) {
                        col.style.display = 'flex';
                    } else {
                        col.style.display = 'none';
                    }
                }
            });
            
            // Redraw connections after filter change
            setTimeout(drawConnections, 100);
        }
        
        // Add hover effects
        document.querySelectorAll('.node').forEach(node => {
            node.addEventListener('mouseenter', function() {
                const nodeId = this.id;
                const connects = this.dataset.connects;
                
                if (connects) {
                    connects.split(',').forEach(id => {
                        const target = document.getElementById(id.trim());
                        if (target) {
                            target.classList.add('active');
                        }
                        
                        // Highlight connections
                        document.querySelectorAll(`[data-from="${nodeId}"][data-to="${id.trim()}"], [data-to="${nodeId}"][data-from="${id.trim()}"]`).forEach(conn => {
                            conn.classList.add('active');
                        });
                    });
                }
                
                // Highlight incoming connections
                document.querySelectorAll(`[data-to="${nodeId}"]`).forEach(conn => {
                    conn.classList.add('active');
                    const fromId = conn.getAttribute('data-from');
                    const fromNode = document.querySelector(`[data-connects*="${nodeId}"]`);
                    if (fromNode) fromNode.classList.add('active');
                });
            });
            
            node.addEventListener('mouseleave', function() {
                document.querySelectorAll('.node').forEach(n => {
                    n.classList.remove('active');
                });
                document.querySelectorAll('.connection-line, .connection-arrow').forEach(conn => {
                    conn.classList.remove('active');
                });
            });
            
            node.addEventListener('click', function() {
                const title = this.querySelector('.node-title').textContent;
                const desc = this.querySelector('.node-desc').textContent;
                alert(`ðŸ“¦ ${title}\n\n${desc}`);
            });
        });
        
        // Add initial animation
        setTimeout(() => {
            document.querySelectorAll('.node').forEach((node, index) => {
                setTimeout(() => {
                    node.style.opacity = '0';
                    node.style.transform = 'translateY(20px)';
                    setTimeout(() => {
                        node.style.transition = 'all 0.5s';
                        node.style.opacity = '1';
                        node.style.transform = 'translateY(0)';
                    }, 50);
                }, index * 50);
            });
            
            // Draw connections after animation
            setTimeout(drawConnections, 1000);
        }, 100);
        
        // Redraw on window resize
        window.addEventListener('resize', () => {
            clearTimeout(window.resizeTimeout);
            window.resizeTimeout = setTimeout(drawConnections, 300);
        });
        
        // Redraw on scroll
        document.querySelector('.flow-container').addEventListener('scroll', () => {
            clearTimeout(window.scrollTimeout);
            window.scrollTimeout = setTimeout(drawConnections, 100);
        });
        
        // Node click handler
        document.querySelectorAll('.node').forEach(node => {
            node.addEventListener('click', function() {
                const title = this.querySelector('.node-title').textContent;
                const desc = this.querySelector('.node-desc').textContent;
                alert(`ðŸ“¦ ${title}\n\n${desc}`);
            });
        });
        
        // Add initial animation
        setTimeout(() => {
            document.querySelectorAll('.node').forEach((node, index) => {
                setTimeout(() => {
                    node.style.opacity = '0';
                    node.style.transform = 'translateY(20px)';
                    setTimeout(() => {
                        node.style.transition = 'all 0.5s';
                        node.style.opacity = '1';
                        node.style.transform = 'translateY(0)';
                    }, 50);
                }, index * 50);
            });
        }, 100);
    </script>
</body>
</html>

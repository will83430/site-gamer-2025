<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Insta360 X5</title>
    <link rel="stylesheet" href="../../assets/css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Manrope&family=Montserrat&display=swap" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <div class="entete">
        <img src="../../assets/images/gaming.png" alt="Gaming">
        <a href="../../top-du-mois.html">Retour √† la vitrine</a>
    </div>

    <h1>Insta360 X5</h1>

    <div id="badge-top-mois"></div>

    <p class="description">La cam√©ra 360¬∞ la plus avanc√©e de 2025, id√©ale pour les cr√©ateurs immersifs et les aventuriers.</p>

    <div class="gallery">
        <img src="../../assets/images/placeholder.png" alt="Insta360 X5" class="img-centree">
    </div>
    <div class="lightbox" id="lightbox">
        <img id="lightbox-img" src="" alt="Zoom">
    </div>

    <!-- Les paragraphes seront remplis dynamiquement -->
    <div id="product-content">
        <!-- Le contenu sera inject√© ici par JavaScript -->
    </div>

    <script>
        const g = document.querySelector(".gallery img");
        const l = document.getElementById("lightbox");
        const z = document.getElementById("lightbox-img");
        if (g) {
            g.addEventListener("click", () => {
                l.style.display = "flex";
                z.src = g.src;
            });
            l.addEventListener("click", () => (l.style.display = "none"));
        }

        const nomProduit = document.querySelector("h1").textContent.trim();

        // Charger et afficher TOUTES les donn√©es depuis le JSON
        fetch("../../data/equipements.json")
            .then((res) => res.json())
            .then((data) => {
                const produit = data.equipements
                    ? data.equipements.find((p) => p.nom === nomProduit)
                    : data.find((p) => p.nom === nomProduit);

                if (produit) {
                    console.log("Produit trouv√©:", produit);

                    // Badge top du mois
                    if (produit.top_du_mois) {
                        document.getElementById("badge-top-mois").innerHTML = `
                        <div style="background:#ffde59;padding:8px;margin-bottom:10px;text-align:center;border-radius:8px;">
                            ‚≠ê Ce produit est en vedette ce mois-ci !
                        </div>`;
                    }

                    // Mettre √† jour la description
                    const description = document.querySelector(".description");
                    if (description && produit.description) {
                        description.textContent = produit.description;
                    }

                    // Mettre √† jour l'image
                    if (produit.image) {
                        const img = document.querySelector(".gallery img");
                        if (img) {
                            img.src = "../../" + produit.image;
                            img.alt = produit.nom;
                        }
                    }

                    // IMPORTANT : Cr√©er dynamiquement tous les paragraphes depuis donnees_fiche
                    const contentDiv = document.getElementById("product-content");
                    if (contentDiv && produit.donnees_fiche && produit.donnees_fiche.length > 0) {
                        contentDiv.innerHTML = "";

                        // Cr√©er un paragraphe pour chaque donn√©e (sauf la premi√®re qui est la description)
                        produit.donnees_fiche.forEach((donnee, index) => {
                            if (index > 0) {
                                const p = document.createElement("p");
                                p.innerHTML = donnee
                                    .replace(/\\n/g, "<br>")
                                    .replace(/\n/g, "<br>");
                                contentDiv.appendChild(p);
                            }
                        });
                    } else {
                        // Template par d√©faut si pas de donn√©es
                        const contentDiv = document.getElementById("product-content");
                        contentDiv.innerHTML = `
                        <p>üí∞ Prix : √Ä D√âFINIR ‚Ç¨</p>
                        <p>üß© Sp√©cifications : √Ä REMPLIR</p>
                        <p>üåê Fonctionnalit√©s : √Ä REMPLIR</p>
                        <p>üéÆ Exp√©rience : √Ä REMPLIR</p>`;
                    }
                } else {
                    console.log("Produit non trouv√© dans le JSON");
                    // Afficher le contenu par d√©faut
                    document.getElementById("product-content").innerHTML = `
                    <p>üí∞ Prix : √Ä D√âFINIR ‚Ç¨</p>
                    <p>üß© Sp√©cifications : √Ä REMPLIR</p>
                    <p>üåê Fonctionnalit√©s : √Ä REMPLIR</p>
                    <p>üéÆ Exp√©rience : √Ä REMPLIR</p>`;
                }
            })
            .catch((err) => {
                console.error("Erreur chargement JSON :", err);
                document.getElementById("product-content").innerHTML = `
                <p>üí∞ Prix : √Ä D√âFINIR ‚Ç¨</p>
                <p>üß© Sp√©cifications : √Ä REMPLIR</p>
                <p>üåê Fonctionnalit√©s : √Ä REMPLIR</p>
                <p>üéÆ Exp√©rience : √Ä REMPLIR</p>`;
            });
    </script>

    <footer class="footer">
        <img src="../../assets/images/banniere-pied.png" alt="Banni√®re" class="footer-banner">
        <div class="footer-links">
            <div class="footer-item">
                <img src="../../assets/images/logo-blanc.png" alt="Accueil" class="footer-icon">
                <a href="../../index.html">Accueil</a>
            </div>
            <div class="footer-item">
                <img src="../../assets/images/logo-dokk-blanc.png" alt="Multibloc" class="footer-icon">
                <a href="equipements.html">√âquipements</a>
            </div>
        </div>
    </footer>
</body>
<script src="../../assets/js/utils.js"></script>
</html>